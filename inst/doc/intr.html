<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="By Zhiyuan Zhang" />

<meta name="date" content="2019-01-11" />

<title>Introduction to StatComp18054</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp18054</h1>
<h4 class="author"><em>By Zhiyuan Zhang</em></h4>
<h4 class="date"><em>2019-01-11</em></h4>



<div id="section" class="section level2">
<h2>2018-9-14</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Implement at least three examples of different types in the book “R for Beginners”.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>Example 1</p>
<p>This is an example of matrix calculation in 3.5.8 of the book “R for Beginners”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1&lt;-<span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dt">nr=</span><span class="dv">2</span>,<span class="dt">nc=</span><span class="dv">2</span>)
m2&lt;-<span class="kw">matrix</span>(<span class="dv">2</span>,<span class="dt">nr=</span><span class="dv">2</span>,<span class="dt">nc=</span><span class="dv">2</span>)
<span class="co"># Merge vector or matrix</span>
<span class="kw">rbind</span>(m1,m2)</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    1    1
## [3,]    2    2
## [4,]    2    2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(m1,m2)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    1    2    2
## [2,]    1    1    2    2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Matrix product</span>
<span class="kw">rbind</span>(m1,m2)<span class="op">%*%</span><span class="kw">cbind</span>(m1,m2)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    2    2    4    4
## [2,]    2    2    4    4
## [3,]    4    4    8    8
## [4,]    4    4    8    8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(m1,m2)<span class="op">%*%</span><span class="kw">rbind</span>(m1,m2)</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   10   10
## [2,]   10   10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Diagonal operation and diagonal matrix</span>
<span class="kw">diag</span>(m1)</code></pre></div>
<pre><code>## [1] 1 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag</span>(<span class="kw">rbind</span>(m1,m2)<span class="op">%*%</span><span class="kw">cbind</span>(m1,m2))</code></pre></div>
<pre><code>## [1] 2 2 8 8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag</span>(m1)&lt;-<span class="dv">10</span>
m1</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   10    1
## [2,]    1   10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag</span>(<span class="dv">3</span>)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>)
<span class="kw">diag</span>(v)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   10    0    0
## [2,]    0   20    0
## [3,]    0    0   30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag</span>(<span class="fl">2.1</span>,<span class="dt">nr=</span><span class="dv">3</span>,<span class="dt">nc=</span><span class="dv">5</span>)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]  2.1  0.0  0.0    0    0
## [2,]  0.0  2.1  0.0    0    0
## [3,]  0.0  0.0  2.1    0    0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Inverse matrix</span>
<span class="kw">solve</span>(<span class="kw">diag</span>(v))</code></pre></div>
<pre><code>##      [,1] [,2]       [,3]
## [1,]  0.1 0.00 0.00000000
## [2,]  0.0 0.05 0.00000000
## [3,]  0.0 0.00 0.03333333</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Matrix QR decomposition</span>
<span class="kw">qr</span>(<span class="kw">diag</span>(v))</code></pre></div>
<pre><code>## $qr
##      [,1] [,2] [,3]
## [1,]  -10    0    0
## [2,]    0  -20    0
## [3,]    0    0   30
## 
## $rank
## [1] 3
## 
## $qraux
## [1]  2  2 30
## 
## $pivot
## [1] 1 2 3
## 
## attr(,&quot;class&quot;)
## [1] &quot;qr&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Eigenvalue and eigenvector</span>
<span class="kw">eigen</span>(<span class="kw">diag</span>(v))</code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1] 30 20 10
## 
## $vectors
##      [,1] [,2] [,3]
## [1,]    0    0    1
## [2,]    0    1    0
## [3,]    1    0    0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Use table to output eigenvectors</span>
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">eigen</span>(<span class="kw">diag</span>(v))<span class="op">$</span>vectors,<span class="dt">col.names=</span><span class="kw">c</span>(<span class="st">&quot;first eigenvector&quot;</span>, <span class="st">&quot;second eigenvector&quot;</span>, <span class="st">&quot;third eigenvector&quot;</span>), <span class="dt">align =</span> <span class="kw">c</span>(<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">first eigenvector</th>
<th align="center">second eigenvector</th>
<th align="center">third eigenvector</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Singular value decomposition</span>
<span class="kw">svd</span>(<span class="kw">diag</span>(v))</code></pre></div>
<pre><code>## $d
## [1] 30 20 10
## 
## $u
##      [,1] [,2] [,3]
## [1,]    0    0    1
## [2,]    0    1    0
## [3,]    1    0    0
## 
## $v
##      [,1] [,2] [,3]
## [1,]    0    0    1
## [2,]    0    1    0
## [3,]    1    0    0</code></pre>
<p>Example 2</p>
<p>This is an example of function “layout” to split the current graphics window into multiple parts in 4.1.2 of the book “R for Beginners”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))
mat&lt;-<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)
mat</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    3
## [2,]    2    4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(mat)
<span class="kw">layout.show</span>(<span class="dv">4</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOjoAOpA6AAA6ADo6AGY6OpA6ZmY6kNtmAABmADpmOpBmtv+QOgCQOmaQ2/+2ZgC225C2///bkDrbtrbb////tmb/25D//7b//9v///8SIqCzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADE0lEQVR4nO3cwVITURBA0QFBVBQFiSRh/v87BXcu9C7sKl9R535A16uTnpfJJtumaF+qxY6zA4oARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARVNAp5vHkTkzQMdtu7ifGDQGdL69XAjo9P5+Pw4daAbosH1caoNeOn+eWaEZoB9Paz1iLx2unkbmvM07aD9dL3YHrQa0L3YHLQi01h0EKFsK6PXxOn1wSf+5w7aNvZf5qfH3AEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKNmX/+zP6vcWO4xGrAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAohmg0/W23Q3M2ceATjePM4NGgM63d/vx4v7fB+1jQA+XKwEdr572568zKzQDdHy31Aa99rpFE40c5/nb9+WADi9bNNHIcQ6f1rqDXjqMPfMDM85fnlYDOgxd0TNAD3eLfYvN7c8I0Pn211+wDt2JE0Cn91P780bfgx4mP7GRKYsBTbbYcQBVgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBijZFPwE0za13Amcg8QAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">2</span>))
<span class="kw">layout.show</span>(<span class="dv">6</span>)
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">3</span>))
<span class="kw">layout.show</span>(<span class="dv">6</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmAGZmZjpmkJBmtv+QOgCQOjqQOmaQ2/+2ZgC2/7a2///bkDrb////tmb/25D/29v//7b//9v///97PZtAAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD1klEQVR4nO3c0VLTUBRA0apFRFFEKoUK+f/PtHzBnuPM1Tqz7nNmJd25J8lTdzsr1rZ0LebX+wKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFL1D4AoUvUPgChS9Q+AKFPwz0cvs4PMHo6MNud7fYfzf7AcNAL5+H/uwHPO/Hd2Dkv94/jPBtGuj1x8+1O2i+RUf+6Xp49Rc3Yttx6Yg9v7/a7Yf+hQU6PyZmhWb+r6ftOPQvLtDx5rL8iwp0fkgv3UFv/v+9g86v4dkNXu/7UAxfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwrVyL78Ba3oj9c1+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8EeBXr/vdvvhCWaHb8eblf5xfv2jQMf9udHd7ASz6zldrQx0+vQ0vv7xiA1v8Yx/vf+6MtB0e25/EOjl9nF2gtHRx5ulI3b4drV2xM59vjwMTzA5+DwCawN9eNoOS0fs9HHYZzgCb/8MunCE3+JMHxGjQKfr2XxtF/YWe95va3fQYfEd3v7Ca37q+1AMX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8AUKX6DwBQpfoPAFCl+g8K1YvwG3nQTr2mMaRAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">3</span>),<span class="dv">2</span>,<span class="dv">2</span>)
<span class="kw">layout</span>(m)
<span class="kw">layout.show</span>(<span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAASFBMVEUAAAAAADoAAGYAOpA6AAA6ADo6AGY6OpA6ZmZmAABmADpmtv+QOgCQ2/+2ZgC2///bkDrbtrbb////tmb/25D//7b//9v///+vIR/xAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC20lEQVR4nO3cS25TQRBA0YaETwghxnZ4+98pMnNyJ6XIap2zgFL7ql97VmsRjrtyZ8c5BAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoChalA16+vI3N2DfT29Fmgd5zWdzfoPb/PPrEgUBAoCBQECgIFgT7KnR1HoCJQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKewa6rPXpZWLQpoGuX16Oy9Bixy0D3bz9mLlC6+6M/KzjOD2cR+bMnWjIzHGuj96g4A0Kg2/QyJwxAoWJ49w+r+s3j/T/ndYa22+9ZaBBAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQmAl0fVzreWDOsWmgt6fn4zK0VW3LQJeH8/Hn58wV2jLQze0WTdg20Nhix5Epc6YCncZ2hs2MGTMU6DS1+HLTQGP3Z9NAt/XEU7YM9OvfGl//Yh/izo4jUBEoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaCwCH8B232KufdIPmwAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)
<span class="kw">layout</span>(m,<span class="dt">widths=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">heights=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">layout.show</span>(<span class="dv">4</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOjoAOpA6AAA6ADo6AGY6OpA6ZmY6kNtmAABmADpmOpBmtv+QOgCQOmaQ2/+2ZgC225C2///bkDrbtrbb////tmb/25D//7b//9v///8SIqCzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADH0lEQVR4nO3c227TQBRAUbf0AhQKLQ25NP//naR9R2uELGtQ93qOjkc744kjRVmWwHkVK42ZToGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEI4GO9y8Dg1ZYzJDDslw9bXWxoUCnh+uJAh3vns6HkQWtxIF2y5epdtDF6dt2W8iBfu/nusUudjf7za71/51B5+PtZGfQbIHOk51BEwaa6wwqEF8zVaC32+v4uUP673bLsuER1FcNKRAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUCAoEBYIltFLpdcZMp0BQICgQFAgKBAWCAkGBoEBQICgQFAgKBAWCAkGBoEBQICgQFAgKBAWCAkGBoEBQICgQFAgKBAWCAoEDHW+X5XFg0CrLGXK8f9nuYgx0eng8H66ePGilBQ14vp4p0OFmf3794S20XaDDp6l20Ju3XcRBKyxmyOvPX9MF2l12EQetsJghu69znUEXu5F7fqtAp+/72QLtBo7o7QI9P072KTa2fzYLdHp4/+nywHPHShjoeDeyfz7wc9Dz4Dv2YQMND1pnzHQKBAWCAkGBoEBQICgQFAgKBAWCAkGBoEBQICgQFAgKBAWCAkGBoEBQICgQFAgKBAWCAkGB4N/+WfAj+QOq9613hgbTfAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)
<span class="kw">layout</span>(m,<span class="dt">widths=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="dt">heights=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">layout.show</span>(<span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAQlBMVEUAAAAAADoAAGYAOpA6AAA6ADo6AGY6ZmZmAABmtv+QOgCQ2/+2ZgC2///bkDrbtrbb////tmb/25D//7b//9v///8bolO5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC30lEQVR4nO3d2W0CQRRFwfEOXjCLyT9VLwH4qCUjD+o6AVxB6QFfaJZF0fmqu/TLB1T7gGIfUOwDin1AsQ8o9gHFPqDYBxT7gGIfUOwDin1AsQ8o9gHFPqDYBxT7gGIfUOwDin1AsQ8o9gHFPqDYBxT7gGIfUOwDin1AsQ8o9gHFPqDYBxT7gGIfUOwDin1AsQ8o9gHFPqDYBxT7gGJ/KqDj/bJsB/dnAjpttufDzcvY/kxAh7v9+eN57ISmAvru+4qG9mcD2n1d0dD+ZEC727fB/bmAdoNf0bMBDd/PZEDHh9H7mQzo9ec/un7F/nYfUOwDin1AsQ8o9gHFPqDYBxT7gGIfUOwDin1AsQ8o9gHFPqDYBxT7gGIfUOwDin1AsQ8o9gHFPqDYBxT7gGIfUOwDin1AsQ8o9gHFPqDYBxT7gGIfUOwDin1AsQ8o9gHFPqDYBxT7gGL/6oEu33+/xXUHKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYrWBnR8HH40yGVbGdBpM/7slMu2LqDd8uSCfut97yMWAYoARYAiQBGgCNC1BSgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQtCj6BOSsJIjMeJ3DAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="kw">matrix</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>)
<span class="kw">layout</span>(m,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">layout.show</span>(<span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAASFBMVEUAAAAAADoAAGYAOpA6AAA6ADo6AGY6OpA6ZmZmAABmADpmtv+QOgCQ2/+2ZgC2///bkDrbtrbb////tmb/25D//7b//9v///+vIR/xAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC50lEQVR4nO3cy27TUBRAUfcFlFJqEgf//5+SMEcrA+vWRnuPI19r6fhYkaJM6zZN/21bAW10nb0VEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgNDxgJbnaXobddgBgS6vb+v54X3QaQcEOj+d1t8/xo3Q4YBu3aZoVIcEmq9TNKojAs2PH+MOOyDQPHBFHxFo6PwcEGh5GTk/BwT6+ffH3b3FdlNAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIffJf8B2ijaS3uczuCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIBQQCggFhAJCAaGAUEAoIHQP0PLl444LbXAzd3Wepof3UYfdBXR5fdwR0PLyvp7vuaGNMtA8fdvVBF27fB83Qgb6ddrXI3ZtfjoNO+t4O2hdnne2g/YGtO5sB+0QaF87KCB+ZldAt8dr+dqS/nfzNA1cQX3VUAGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCAUEAoIBYQCQgGhgFBAKCA0FfoDSxOKi/P8t60AAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="section-1" class="section level2">
<h2>2018-9-21</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>A discrete random variable X has probability mass function</p>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">p(x)</td>
<td align="center">0.1</td>
<td align="center">0.2</td>
<td align="center">0.2</td>
<td align="center">0.2</td>
<td align="center">0.3</td>
</tr>
</tbody>
</table>
<p>Use the inverse transform method to generate a random sample of size 1000 from the distribution of X. Construct a relative frequency table and compare the empirical with the theoretical probabilities. Repeat using the R sample function</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>This is the inverse transform method to generate a random sample.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>)
p&lt;-<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>)
cp&lt;-<span class="kw">cumsum</span>(p)
m&lt;-<span class="dv">1000</span> 
<span class="co">#the random sample is in numeric r </span>
r&lt;-<span class="kw">numeric</span>(m)
r&lt;-x[<span class="kw">findInterval</span>(<span class="kw">runif</span>(m),cp)<span class="op">+</span><span class="dv">1</span>]
<span class="co">#the sample frequency is in ct</span>
ct&lt;-<span class="kw">as.vector</span>(<span class="kw">table</span>(r))
result&lt;-<span class="kw">rbind</span>(x,ct<span class="op">/</span><span class="kw">sum</span>(ct)<span class="op">/</span>p)
<span class="kw">rownames</span>(result)&lt;-<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;relative frequency&quot;</span>)
result</code></pre></div>
<pre><code>##                    [,1] [,2] [,3]  [,4]      [,5]
## x                  0.00 1.00 2.00 3.000 4.0000000
## relative frequency 0.99 0.97 1.03 1.025 0.9866667</code></pre>
<p>This is to use the sample function to generate a random sample.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>)
p&lt;-<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>)
<span class="co">#the random sample is in numeric r1 </span>
r1&lt;-<span class="kw">sample</span>(x,<span class="dt">size=</span><span class="dv">1000</span>,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span>p)
<span class="co">#the sample frequency is in ct1</span>
ct1&lt;-<span class="kw">as.vector</span>(<span class="kw">table</span>(r1))
result1&lt;-<span class="kw">rbind</span>(x,ct1<span class="op">/</span><span class="kw">sum</span>(ct1)<span class="op">/</span>p)
<span class="kw">rownames</span>(result1)&lt;-<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;relative frequency&quot;</span>)
result1</code></pre></div>
<pre><code>##                    [,1] [,2]  [,3] [,4]      [,5]
## x                  0.00 1.00 2.000 3.00 4.0000000
## relative frequency 1.04 0.99 1.105 0.95 0.9566667</code></pre>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Write a function to generate a random sample of size n from the Beta(a, b) distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the Beta(3,2) distribution. Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>Beta(a, b) distribution with pdf:<span class="math inline">\(f(x)=\frac{1}{B(a,b)}x^{a-1}(1-x)^{b-1}, 0&lt;x&lt;1\)</span>. Take pdf:<span class="math inline">\(g(x)=1,0&lt;x&lt;1\)</span>. We take constant c bigger than the maximum of f(x), then <span class="math inline">\(f(x)\leq cg(x)\)</span> for all x.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">randomBeta&lt;-<span class="cf">function</span>(n,a,b){
m=(<span class="dv">1</span><span class="op">-</span>a)<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>a<span class="op">-</span>b)
max=m<span class="op">^</span>(a<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>m)<span class="op">^</span>(b<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span><span class="kw">beta</span>(a,b)<span class="co">#maximum of f(x)</span>
c&lt;-max<span class="op">+</span><span class="dv">3</span> <span class="co">#take c bigger than the maximum</span>
j&lt;-k&lt;-<span class="dv">0</span>
y&lt;-<span class="kw">numeric</span>(n)
<span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n) {
u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
j &lt;-<span class="st"> </span>j <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g</span>
rho&lt;-x<span class="op">^</span>(a<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span>(b<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span><span class="kw">beta</span>(a,b)<span class="op">/</span>c
<span class="cf">if</span> (rho<span class="op">&gt;</span><span class="st"> </span>u) {
<span class="co">#accept x</span>
k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
y[k] &lt;-<span class="st"> </span>x
}
}
<span class="kw">return</span>(<span class="kw">list</span>(<span class="st">&quot;random sample&quot;</span>=y,<span class="st">&quot;times&quot;</span>=j,<span class="st">&quot;c&quot;</span>=c))
}
result&lt;-<span class="kw">randomBeta</span>(<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">a=</span><span class="dv">3</span>,<span class="dt">b=</span><span class="dv">2</span>)
y&lt;-result[[<span class="dv">1</span>]]
<span class="kw">hist</span>(y,<span class="dt">probability =</span> <span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;Beta(3,2) distribution&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))
x&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)
<span class="kw">lines</span>(x,x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">/</span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">2</span>)) <span class="co">#pdf of Beta(3,2)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6Ojo6OpA6kNtmAABmADpmtv+QOgCQOjqQZgCQtpCQ27aQ29uQ2/+2ZgC2Zma2/7a2/9u2///bkDrb/7bb/9vb////tmb/25D//7b//9v///811evTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKs0lEQVR4nO2d6WLrJhSElcZp61ynW9T2qq2S+P1fsmKTBFpGLBLYnvmRGBsO8BkOICFcXalVVbkLULoICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICCgJoKbSev7P/ejP73b48/Xp/Xr9eusin8fvduEfuqgfLz84Ca5190EX3zU9Mqw+ratJ0iHqjIGNSgvILePnq1voRhRU8qiqk3mzVYk7dF1FznaCeUCW4XVAMmoxgJzqTQqtAHTxL+qPebOL9vEi6tBMKjJb8Zk3lwAtt6xNSgRIlaGr40mVSTWPWjeq7v1KtA/RVlQz6Sh0b2pAXYNSsVXUS2+3FqlGLagx3Vgbbqqn316qpz9MC/rrVfdyBaWze9ZR/9YtSJbkrMosTKtSHQnofDUdqHtL12PoQX1MWQmncLJWslJK0lEpCwpQUzmG1RvP/2pAQy9fAtQMrtK0ekQocRdTX29fUfmyq91Jw1MvhdpJ0fp2ZPpYK5th3QNSEdqqNyzyFZGNDxJ/TaIeUF8G1WgVZ9XNu/cb1ynsDehiiqXaytD/G9nrNIQ+PJZuUUOSvpYaUFe9UfPTgER/NICG9AuAtO1ao7kMTuEwQF2JZDfXjVeVyPSVk+6DSuPXstSDb5BvmNbW+yBt5jwGJONatW+GfF1AZiiTUVTa4RvbGZD6auW33VYOIFmxiyyKBcUaXgyfAZAp++CktXMT3/wsoKH2tZ5U2YCMxVYNohkAyVzH45AZmM66KIuAej5WC+pHpH4aY8axTS3IBZS/BXUleHof5ykL15reftZF1pgGdyz4XHpbxnm7Puj69YvjZBxA0oZ2MOKDkT+f80GHAhoPY7KkXc5ywOhKIccO0c+Mk5YcVfH78dtmKuWOYmoMMinUpMEGpL6N01UNTiLLs440N4plAaQzNS9bPQcxTlo7Xu3HTXWNb9FTmHG7mpsH9Ya/u4B6I/1AcR7KMJr8nK65APU9zaxb5VxVhJ/eG9Ww5fsSydnUrR0ltxZjos6XkQ+S9VZ51Mqk7YP6mbSM+fzPq+7KZrKtLVyuRwParnYyc63tAn68wMn/sToYUPdlX6w3Pl7scBu66t5LR18wa+wm/fXmzPRrNPU/WkcDml4hsjRzwSyzeMkViICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAjID5DZ6VParYcd5QWoMTet2tLuXu0nH0Cju3xNYfc/95MPoM/X/jZx+zCdjC0IyNMH6SZEH7Qgs9XpYdoP50FQBAQUCKjhKOZnpVcScyUpcY0I6FhzBcivRk2/iXbBBz04oObpvZsKyW3YGQFVrvbNzSOuWmp8vYlN7zkBHZpnyGK1fv6PgObUL1brEwHNymCRjyjFmwtUwYD65fzXGwEVYW5THgQE8iCg2TyGWRABTfMYzw53nireIiAHSDV9K2VuRZuby2HCoto151sDVC066Z0a0W0BkhCWRjECWuhM1eRF+jxLNWfbNn1pMc89etntAFpsKNXC68TZFmlu1vLqTDp5AW4FUDX7ciacugQ3AmitG1WrwZQ5l2dOG12/Br3v4vU2AK3mcRAgfA7KmpVd7zCAPjTJM2khRsaaCp6Z52MumVzquMWkLIVtK5rRLjO1ggApRBE7N3aZqHkDSlkMy1Qr7yzLO4MpzAUbWR+2cgH67M+3itjCmgaQ8xIBmuGZjtBoFEtxNlZiQLPL903DfDJCA6Bvik/cDui0gOaX75kBxW2uSwpo4UoYBJR084dOXg/28g/z7jXUkBaU7DLapAUlMhdvZPH6xsalxgLesMIkUzpAy9c3tq7F5j1YUGHS6V4Bfb6erQNVI81Fyp3IBAKanySEFCahUgGqnPBaHo8IqHLCq3ksh1PMiMZLjbP5mYFFwWdW7xlQLY60Prmn81rCz6wmWqyuGt0OaOLNQgpjXogtrG23ll9Zamx44jD1YnUunBFQLY7EXga04ZnVFIDQVXkPQBN/H1Ca/lV9+nwVx6cvd7FjWtB0y1ghgLqJkDhdfe3KPX5mNR7QTJUKAbRF8JnV0gDNtEf/8qRUtLk5t1oIoCTncsQCmp25xACK3hIzctI+ZHZ6VmN+cVAGIDGRDreS9PJdUkBJ50HxCioNuM1TCKD1Ad7bXEgi9/+C0UyA5DojWjGAKie8ZNQXUByhURfLdsHsNgBtUM9wGWMEoMoJLxr17mJRhLwSLz5HF2bOSuSswVeMZgMkfzOtXh3soScPBuQsoNaM5gLUPr03YjW/Sgh58iIBRREaDfNneREjw61ntwplAhITRQEow+YFcA26EECmBdVRx28FzqTXjZQBSPugJm66GDWT3hgOiB5ByB7FKvzz4pvNhScqFVAKhZjz3TofEj28mgQE5KzFYg9IDCgIvIuRAlA4IZOwNj/PGrfX3r8cM4NMiYBa45zd3z0NM+eX4AhAwYRUutEaa+3e/FZzngluANBoBXbsUmPWgxYJKNFJ0duK4XcN+hEB2f8PARRKKCegpaITkDPy7gwobue9AQSvNvuY2xSrsoMrRtK2oCBAsfL8epyx/RhAgd46DSBPc87smYBmYmUAFLboyASosoPrRh4QkB2NgEAsAnIjZQLkTi82KQMg75MCHgxQlbDGntEJCES/CUDVNNZhgOYyRzoa0NyXSEDu5wQEPs4GaMYBIh0JKO6kgCTR9wYU9UimO6VdTHS7gEIfyQQX9e4GUPADda5vzAfo6r1j0Sd68COZ7vd2r4DCW9D69Y27ART8SOaeNS4KUNgjmXs/vuMXPey2TzLpmfKhzzfdIqA+qIrzgIDWH8l0Z8wlAdrXBy1asTvTpIsVpRyA7lgEBOQHKMmz9belxIvV+1PipYY2WrT2A7R5mxUyCj6P+zg2eUT07S0oLtObBbRhsbrN6N0CwovVbUbvF1AiowQU9zkBEVDc5wT08IDuSQQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQCkBtdXoACsr4J/8evU9Tc1KLn7sM8XpxkkBiRNk+lNkrIB/chH2O8zISt6IQBpC6QCpm0L68Bgr4J/8qs8FDc795Jn7stIBUicP6Y1DVsA/uXj1/KsPICt5oYB+FO1b33K1Av7JZdDLB9nJi+xiygFoN2AF/JPLHuMFyMnQf4hYUqGAvM8EtZOLX3j4eEmyA6XMLiYD4V3M3wMuq0wn3eidKtu9iJXcv/0uq9hh3rMFWckVrbiTkIzKnSh6zqSt5EX6INkxRAnVLEQHQpNfvZcaVnLx08xpdglysQpEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBApQOSW6KaJBt6w1Q6ILFN7OstzVMFQSodkDj1Sm3QzKTSAYk+tn7c1c4qHlDXx+qcR+4VD+jz2+/fMvaw8gF9vf2Us4eVDyj6F94jVT6grGPYTQD6OWcPuwFATd5jY0sH9PGS1UWXDyi7CAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgID+B/VxJpR/RFpRAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">times&lt;-result[[<span class="dv">2</span>]] <span class="co">#times of acceptance-rejection</span>
times </code></pre></div>
<pre><code>## [1] 4830</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">c&lt;-result[[<span class="dv">3</span>]] <span class="co">#constant c</span>
c</code></pre></div>
<pre><code>## [1] 4.777778</code></pre>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the rate parameter ?? has Gamma(r, ??) distribution and Y has Exp(??) distribution. That is, <span class="math inline">\((Y |?? = ??) ?? f_{Y}(y|??) = ??e^{-??y}\)</span>. Generate 1000 random observations from this mixture with r = 4 and ?? = 2.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="dv">1000</span>
r=<span class="dv">4</span>
beta=<span class="dv">2</span>
lambda=<span class="kw">rgamma</span>(n,r,beta)
x=<span class="kw">rexp</span>(n,lambda)
<span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;Exponential-Gamma mixture&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level2">
<h2>2018-9-28</h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1:</h2>
<p>5.4 Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2, . . ., 0.9\)</span>. Compare the estimates with the values returned by the pbeta function in R.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>The <span class="math inline">\(Beta(3, 3)\)</span> cdf:<span class="math inline">\(F(x)=\int^{x}_{0}\frac{1}{B(a,b)}t^{a-1}(1-t)^{b-1}\,dt\)</span>. Use antithetic variables to compute a Monte Carlo estimate as follows: <span class="math inline">\(g(U_i)=\frac{1}{B(a,b)}{U_i}^{a-1}(1-{U_i})^{b-1}x\)</span>, <span class="math inline">\(\hat{\theta}=\frac{1}{m}\sum_{i=1}^{m/2}(g(U_i)+g(1-U_i))\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mypbeta&lt;-<span class="cf">function</span>(a,b,x){ <span class="co"># antithetic variables to compute a Monte Carlo estimate of the Beta(3, 3) cdf</span>
  m=<span class="dv">1000000</span>
  u=<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>x)
  u1=<span class="dv">1</span><span class="op">-</span>u
  g=<span class="dv">1</span><span class="op">/</span><span class="kw">beta</span>(a,b)<span class="op">*</span>u<span class="op">^</span>(a<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(b<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>x
  g1=<span class="dv">1</span><span class="op">/</span><span class="kw">beta</span>(a,b)<span class="op">*</span>u1<span class="op">^</span>(a<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u1)<span class="op">^</span>(b<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>x
  theta=(<span class="kw">mean</span>(g)<span class="op">+</span><span class="kw">mean</span>(g1))<span class="op">/</span><span class="dv">2</span>
  sd=<span class="kw">sd</span>(<span class="kw">c</span>(g,g1))<span class="op">/</span>m
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="st">&quot;theta&quot;</span>=theta,<span class="st">&quot;sd&quot;</span>=sd))
}
x=<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="dt">by=</span><span class="fl">0.1</span>)
MC=<span class="kw">numeric</span>(<span class="dv">9</span>)<span class="co"># Monte Carlo estimate</span>
sd=<span class="kw">numeric</span>(<span class="dv">9</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>){
  result=<span class="kw">mypbeta</span>(<span class="dv">3</span>,<span class="dv">3</span>,x[i])
  MC[i]=result[[<span class="dv">1</span>]]
  sd[i]=result[[<span class="dv">2</span>]]
}
pBeta=<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)<span class="co"># the values returned by the pbeta function in R</span>
cdf=<span class="kw">rbind</span>(MC,pBeta)
knitr<span class="op">::</span><span class="kw">kable</span>(cdf,<span class="dt">col.names=</span>x)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">0.1</th>
<th align="right">0.2</th>
<th align="right">0.3</th>
<th align="right">0.4</th>
<th align="right">0.5</th>
<th align="right">0.6</th>
<th align="right">0.7</th>
<th align="right">0.8</th>
<th align="right">0.9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MC</td>
<td align="right">0.0085631</td>
<td align="right">0.0578784</td>
<td align="right">0.1629639</td>
<td align="right">0.3176655</td>
<td align="right">0.5003429</td>
<td align="right">0.682496</td>
<td align="right">0.8374645</td>
<td align="right">0.9431792</td>
<td align="right">0.9910459</td>
</tr>
<tr class="even">
<td>pBeta</td>
<td align="right">0.0085600</td>
<td align="right">0.0579200</td>
<td align="right">0.1630800</td>
<td align="right">0.3174400</td>
<td align="right">0.5000000</td>
<td align="right">0.682560</td>
<td align="right">0.8369200</td>
<td align="right">0.9420800</td>
<td align="right">0.9914400</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matplot</span>(x,<span class="kw">cbind</span>(MC,pBeta),<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="co"># Compare using figure</span>
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">inset=</span>.<span class="dv">05</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;MC&quot;</span>,<span class="st">&quot;pbeta&quot;</span>),<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>5.9 The Rayleigh density <span class="math inline">\([156, (18.76)]\)</span> is <span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},x\ge0,\sigma&gt;0\)</span>. Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span>?</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>The cdf:<span class="math inline">\(F(x)=1-e^{-\frac{x^2}{2\sigma^2}}\)</span>. It’s easy to generate samples using the inverse transform: <span class="math inline">\(X=F^-(U)=\sqrt{-2\sigma^2\ln(1-U)},U\sim U(0,1)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myrRayleigh&lt;-<span class="cf">function</span>(n,sigma,<span class="dt">antithetic=</span><span class="ot">TRUE</span>){
  u=<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)
  <span class="cf">if</span>(<span class="op">!</span>antithetic) 
    {v=<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)}<span class="cf">else</span>
    {v=<span class="dv">1</span><span class="op">-</span>u}
  u=<span class="kw">c</span>(u,v)
  x=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))
  <span class="kw">return</span>(x)
}
n=<span class="dv">1000</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
MC1=<span class="kw">myrRayleigh</span>(n,<span class="dv">2</span>,<span class="dt">antithetic =</span> <span class="ot">TRUE</span>)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
MC2=<span class="kw">myrRayleigh</span>(n,<span class="dv">2</span>,<span class="dt">antithetic =</span> <span class="ot">FALSE</span>)
<span class="kw">qqplot</span>(MC1,MC2) <span class="co">#Compare the order statistics of the two groups of samples</span>
y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>)
<span class="kw">lines</span>(y,y,<span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(MC1)<span class="op">/</span><span class="kw">var</span>(MC2)<span class="co">#percent reduction in variance</span></code></pre></div>
<pre><code>## [1] 0.01562257</code></pre>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>5.13 Find two importance functions <span class="math inline">\(f1\)</span> and <span class="math inline">\(f2\)</span> that are supported on <span class="math inline">\((1, ??)\)</span> and are ??close?? to <span class="math inline">\(g(x) = \frac{x^2}{\sqrt{2\pi}} e^{-{x^2}/2}, x &gt; 1\)</span>. Which of your two importance functions should produce the smaller variance in estimating <span class="math inline">\(\int_1^\infty\frac{x^2}{\sqrt{2\pi}} e^{-{x^2}/2}\,dx\)</span> by importance sampling? Explain.</p>
<p>5.14 Obtain a Monte Carlo estimate of <span class="math inline">\(\int_1^\infty\frac{x^2}{\sqrt{2\pi}} e^{-{x^2}/2}\,dx\)</span> by importance sampling.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>First, g(x) is similar to the form of a normal distribution, and peak is about 1.5. To make sure <span class="math inline">\(f_1(x)\)</span> is supported on <span class="math inline">\((1, ??)\)</span>, we can define <span class="math inline">\(f_1(x)=\frac{1}{ (1-\phi(-0.5)) \sqrt{ 2\pi}} e^{-(x-1.5)^2/2}\)</span>. We get random samples of <span class="math inline">\(f_1(x)\)</span> from <span class="math inline">\(N(1.5,1)\)</span>, excluding <span class="math inline">\(x&lt;1\)</span>.</p>
<p>Then, we define <span class="math inline">\(f_2(x)=xe^{-\frac{x^2-1}{2}}\)</span>. Taking <span class="math inline">\(Z=X^2-1\)</span>, then <span class="math inline">\(f_2(z)=\frac{1}{2}e^{-\frac{z}{2}}\)</span>. Z is an exponential distribution.</p>
<p>It’s obvious <span class="math inline">\(Var(\hat{\theta})=Var(\frac{g(X)}{f(X)})/m\)</span>, which has the minimal value 0 when g(??) = cf (??) for some constant c. The more similar the shape of <span class="math inline">\(g(x),f(x)\)</span>, the smaller the variance. It can be found <span class="math inline">\(f_1(x)\)</span> is more similar with <span class="math inline">\(g(x)\)</span>, thus has smaller variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="fl">0.1</span>)
g=<span class="cf">function</span>(x)x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)
f1=<span class="cf">function</span>(x)<span class="dv">1</span><span class="op">/</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="op">-</span><span class="fl">0.5</span>))<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>((x<span class="op">-</span><span class="fl">1.5</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)
f2=<span class="cf">function</span>(x)x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>((x<span class="op">^</span><span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)
<span class="kw">plot</span>(x,<span class="kw">g</span>(x),<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>)
<span class="kw">points</span>(x,<span class="kw">f1</span>(x),<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>)
<span class="kw">lines</span>(x,<span class="kw">f2</span>(x),<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">inset=</span>.<span class="dv">05</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;g(x)&quot;</span>,<span class="st">&quot;f1(x)&quot;</span>,<span class="st">&quot;f2(x)&quot;</span>),<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">horiz=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOjoAOpAAZrYAzQA6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtv+QOgCQZgCQkGaQ2/+2ZgC2tma2/7a2///bkDrb/9vb////AAD/tmb/25D//7b//9v///9z8w0/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAANNklEQVR4nO2dC3fbuBGFb9KYabvZXbdRt9pKsfn/f2WJFwlCBDEAQd3x2Xw+MvwYDK7GgwfBhzH+ZBewBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHnd19GFgBMp+GYejr9QTQ3VDuzkRn0B4kdDcUu7OBMeFRHSF0N9z3EnXtwYbHplEX3+eA7oZid0sP09zN0N1Q7m7wPaytmz1p9sKOhId31BHrLs6f6gh1FpRzL25GbFjpLuTPzwBl3bn8+RmgvLu29RCKFodAUoordG7fMrQMQyhaHAJJKa7QuX1Pw3oIRYtDICnFFTq372kYqFG0OASSUlyhc/uehoEaRYtDICnFFWRcgJf312m59bvQXf1AXSeoGiSluIKI65f/TTF6Gce3b78I3VUP1FWC6kFSiitIeH+dwnL/9H10oRK6qxyoawQ1gKQUV5Dw9m3qWffP/x3DZ5G7yoG6RlADSEpxBQmtGVQ1UNcIagBJKa4gYh6DbKik7vzR/RmCcry/hlnk7dfvm+7FzdTpqZ7FLFXTWJ2gDNeX+cv7OteRlEXEhsfcyWOU81CDHSw9SzKt3Iub6aFH4E6+eZbzIGFK8E//nsZIM4Vcp5ddjayHSyTlWXqu8lnMUDHVNwoyXCZRd0wBuvhh0sbGzSqpe3EzB/TEXgrn4yqm+rUH0fap58dX05kun767Zez98x92gHY/Tt1nhJb0HCbjrmKqz3gQ4FdoJkA2JHa+TVf9SMoT9VS5k0/1OQ9lriFAPmfubq59aoDsFD+RGYF23ImnsTpBMUkGvb/+Zn/wzABd4du6o2KhGJDFqErQCpc41zAGXb/8aZezTxyDovVzxaHGjGyqrxGUsJrFTBrZnHriLBatvyoOVgPCqb5GUMq0Dvr8HxOl6XWZ/oTvry9PXQcdyyDhVF8jaIu7XSAuvSr+ejx/DPKNtYxBwqm+StAKO9j48Yd1LPb2zc1imfwpjEGiqb5O0Io7wmE07Wj+mDvRNLbr4ThISnGFzu3nKMeo5OEgSEpxhc7t5yhP9SUPB0FSiit0bj+DYKoveDgKklJcoXP7GQRTfcHDUZCU4gqd289wboCusKuPH/+wi9jtmQxJWeSAnhZ35am+5CGPPyp9++ZW+dtrISRlkXY9be5OnMXcmvnu9xoy+9JIyiLteprdnZRBP76a0Exr/OXU5sa+NJKySLOednf7a6G1h9su65ohZ1yAMvvSSMoiYsMD7sxbCa+xtBZqF7QKUG5fGklZpF3Pykt2097/oefX7VZYC7ULSgK0vS+NpCzSrkfk7mZiYgr3Yb4ZbrtTfbugVYBy+9JIyiLtesrufPKsRg0TnZBFnQVtZNDjvjSSski7nqK7mw/OGH3cfAo9aQx63JdGUhZp17Pvbs6e0MeW7nYz09jDHHRc0OMstrEvjaQs0q5n153PHh+RZRYL39oYdRa0DlBmXxpJWaRdT95dlD1jmin+p3aq38yiXoIy+9JIyiKz4ds3vOzYVbhbZc+Gzc3EZsqfaaje+D0eK7TR/1hsOhjO7cWLwbzcGR+zJ2BmMZM/ZqR+sMCjfRunHM0fjhFcAmWzxzPMWfQQQ2zZ9wNJKa4QuO6defesT+am7tw7zs5SDpM/Q1hA7grqDJJSXMFyt6dN3l8zZ3XCSZ+dyxeMu3BYsYs9Yr1t2GLTvBtISnEF9/ZdZHLnlcP5wv0MKmZPwMcoMUfOvA9ISnGFKT6fvu/YBSMTwlKAhAyDO+5YD1c1HhLMlqu9QMf+GUlbrpcpjH0CZI7HbmExtESoVtCCObp4f530Xe2ChbXlesUvvQJkIjTcxnU3qxY0Y5aD/hqh5AKG5265/vj6t34BshP+qpvVC5p1zVPHPX8pMJKySIOeqZv3GYPc5uKcP7cND8Mua39LzpgrqT7SlmsO/xZD/mwFqIY5QGayZW+5Vl5InsXFyOWPy6NGQWN0NI8XdVuupQvJc4T9+2jbul2Qj4lbrH2ILdciy5lot/FoItQuyAXIX4n7EbZcy8Sn6sN03y7IxiRcJUjacm2/kHyT+LLFMN3XeYhx66CQKpQt12MXkm8QX8tw6xGgq/sD+nXQs7dcD15IvkW8oHHTfa2HHN23XOvabLiQPEd0JvrYNJ9AOBY7IYOSq/IOTfMJjKP5xgvJzfJIeK/dkVlMBJJSXEFG/YXkfvGI5cuE9AL8OkHVICnFFTq3776xEbGvMXzxGKTkqrzOglKQlOIKnduPgzMfhYQfJHXWh+adBeUEipsRG1a3Pwdn9B8hSBvjUTSTdRa0I7CuQt/2TZFmzdzDHrMonsk6C8oI5AYo9C6sohJ1uTHJongm6yxoU2BNM2JDuTssIVoPyiFID1kUz2SdBW0JrGpGbCh2ZzziITizQZQ/y++jJ3l1FrQhcFWKK/RrH0sO5W3SLFqe5IWTqX3fYkOxOxT9RvkTJ1Fy8Wuymd+ZPX1thnJ34VWwc39PBNPH+1zmzXzZmew6SgLrDSvc7XSvxXAZpZyxH6hX53LSc2YdKSusNdz3knZxWdN+HHK1hugVOK+bobvhCe6WUchWGzYehX9aN0N3w1PcYT3j+3HoGd0M3Q3Pcefzx2eRXw7lulnPLEJ3w7PcmRpzFs35s9HN+mYRuhue5g7xunF+FP52N+sXIXQ3PM9dPArZJMp1s62LYltBd8NT3SHKonw327oothV0NzzX3Wou2+xmc3T6ZBG6G57uDksWDdjoZv4Ch/l+mGOgu6Gl87n5pO6SRQPgu1mcRQ83WB1prLuhofu5+Y3qLoumwEwxQpJF0S16R7uaWKjYcDzpzGpSf86iwbwG/zn8ernJ82hXEwsVG45nnZvfcGG78QC3jTa4/ra6CCTuam1BEgsVG45PySDrI6yIpqD4/ImDtNy3eBvbgyQWKjY0HHrIWw0Y/cLaxWXAEiT7++h+6lWQ5IESCxUbWg495K0Gv5XmBus5SIMdt223G6K4LEEaxYESCxUbPt+dD1LUwwa757icBLlFrzEEzr+iHz28aoT2fEf93dkgDWEYsukzuo8x3BZsrtW3L/O1fdkbQNytRGP2JRba+I56XUguYQ6S7WPzbQjzxxQP+3n57ja4hxdsf7izS+LWu72H6j3p2gbMODTal9vdb4URoLPcrX3PU33oYeuPW5RNg701X08GneXuwb1fWC+Beny5sWgeyzMvsVCxoeXUg9VK9qYp1ix2+sHq80B3w1F2qPFhOCNAgoPVOqdCO4pZi7kgg+qcCu0oZk3m5YPVOqdCO4pZm3nxYLXOqdCOYtZo3tep0I5i1mje16nQjmLWaN7XqdCOYtZo3tep0I5i1mje16nQjmLWaP7XA2wB2gFbgHbAFqAdsAVoB2wB2gFbgHbAFqAdsAVoB2wB2gFbgHbAFqAdsAVoByf49P+/ap/loav7XO3jkiRcChvBY9gyrnryOmqMZYT/X7VL9NDVXcxlJHdRhO6lnfKJH3+XxToCtRWK3MtP7B7H6KGru9hntdmnbJWYkqMcoP3TeZugtkJRQ/j/VSJjUW6IAnT98q9ygK71/9cA1TXKyAN0EVleBWGcOo9gDLr8UzbwRaDKWoY4QIXzj8FIYGVO+pYD5J4XfqmKEGqMhUgDdBfOJ9mH7C+YU+GCDHLNVg1EqLCVIlQgyh9nWepjdnaSBmjneeEboMJWiixAV/lgUHxL/vmS+edcr7xVzfWosJUiCtBV9G5caGQRL2dQjbcAKmylSBQsD13dxz1tVGQrmcXMoPcxBunloasFLtKeIxqD5N4CqLL+CwK2AO2ALUA7YAvQDtgCtAO2AO2ALUA7YAvQDtgCtAO2AO2ALUA7YAvQDtgCtAO2AO2ALUA7YAvQDtgCtAO2AO2ALUA7YAvQDtgCtAO2AO2ALUA7YAvQDtgCtAO2AO2ALUA7YAvQDtgCtAO2AO2ALaCAuZJ6+V/fBMBrWoS5eGr/YUUnA17TMu6f//i1+v6BjoDYtoxL3c0nvQGzcRH3ymvmOgNm4xLeX3+rvwOlIyC2LeL65U/ZRa4nAWLbEsyjCRtuYuoHeE2LcNdJE4dp8Jr+GIAtQDtgC9AO2AK0A7YA7YAtQDtgC9AO2AK0A7YA7YAtQDtgC9AO2AK0A7YA7YAtQDtgC9AO2AK0A7YA7YAtQDtgC9AO2AK0A7YA7YAtQDtgC9AO2AK083/wFiTzVEbapwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="dv">1000</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
X=<span class="kw">rnorm</span>(<span class="fl">1.5</span><span class="op">*</span>n,<span class="dt">mean=</span><span class="fl">1.5</span>,<span class="dt">sd=</span><span class="dv">1</span>)
X=X[X<span class="op">&gt;</span><span class="dv">1</span>]
X=X[<span class="dv">1</span><span class="op">:</span>n]
theta1=<span class="kw">mean</span>(<span class="kw">g</span>(X)<span class="op">/</span><span class="kw">f1</span>(X))
sd1=<span class="kw">sd</span>(<span class="kw">g</span>(X)<span class="op">/</span><span class="kw">f1</span>(X))<span class="op">/</span>n
theta1</code></pre></div>
<pre><code>## [1] 0.40263</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd1</code></pre></div>
<pre><code>## [1] 0.0001170964</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
Z=<span class="kw">rexp</span>(n,<span class="dt">rate=</span><span class="fl">0.5</span>)
Y=<span class="kw">sqrt</span>(Z<span class="op">+</span><span class="dv">1</span>)
theta2=<span class="kw">mean</span>(<span class="kw">g</span>(Y)<span class="op">/</span><span class="kw">f2</span>(Y))
sd2=<span class="kw">sd</span>(<span class="kw">g</span>(Y)<span class="op">/</span><span class="kw">f2</span>(Y))<span class="op">/</span>n
theta2</code></pre></div>
<pre><code>## [1] 0.404797</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd2</code></pre></div>
<pre><code>## [1] 0.0001237528</code></pre>
</div>
<div id="section-3" class="section level2">
<h2>2018-10-12</h2>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>6.9 Let X be a non-negative random variable with <span class="math inline">\(\mu= E[X] &lt; ∞\)</span>. For a random sample <span class="math inline">\(x1, \dots, xn\)</span> from the distribution of X, the Gini ratio is defined by <span class="math inline">\(G=\frac{1}{2n^2\mu}\sum_{j=1}^n\sum_{i=1}^n|x_i-x_j|\)</span>. The Gini ratio is applied in economics to measure inequality in income distribution (see e.g. [163]). Note that G can be written in terms of the order statistics <span class="math inline">\(x(i)\)</span> as <span class="math inline">\(G=\frac{1}{n^2\mu}\sum_{i=1}^n(2i-n-1)x(i)\)</span> If the mean is unknown, let <span class="math inline">\(\hat G\)</span> be the statistic G with <span class="math inline">\(\mu\)</span> replaced by <span class="math inline">\(\bar x\)</span>. Estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat G\)</span> if X is standard lognormal. Repeat the procedure for the uniform distribution and Bernoulli(0.1). Also construct density histograms of the replicates in each case.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Giniratio=<span class="cf">function</span>(n,distribution){
  <span class="cf">if</span>(distribution<span class="op">==</span><span class="st">&quot;lognormal&quot;</span>) {
    x=<span class="kw">exp</span>(<span class="kw">rnorm</span>(n))
  }
  <span class="cf">if</span>(distribution<span class="op">==</span><span class="st">&quot;uniform&quot;</span>) {
    x=<span class="kw">runif</span>(n)
  }
  <span class="cf">if</span>(distribution<span class="op">==</span><span class="st">&quot;Bernoulli&quot;</span>) {
    x=<span class="kw">rbinom</span>(n,<span class="dt">size=</span><span class="dv">1000</span>,<span class="fl">0.1</span>)
  }
  xorder=<span class="kw">sort</span>(x)
  G=<span class="dv">0</span>
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    G=(<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>xorder[i]
  }
  G=G<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(x))
  <span class="kw">return</span>(G)
}
n=<span class="dv">1000</span>
m=<span class="dv">1000</span>
Gini=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>m,<span class="dt">ncol=</span><span class="dv">3</span>)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  Gini[i,<span class="dv">1</span>]=<span class="kw">Giniratio</span>(<span class="dt">n=</span>n,<span class="dt">distribution=</span><span class="st">&quot;lognormal&quot;</span>)
  Gini[i,<span class="dv">2</span>]=<span class="kw">Giniratio</span>(<span class="dt">n=</span>n,<span class="dt">distribution=</span><span class="st">&quot;uniform&quot;</span>)
  Gini[i,<span class="dv">3</span>]=<span class="kw">Giniratio</span>(<span class="dt">n=</span>n,<span class="dt">distribution=</span><span class="st">&quot;Bernoulli&quot;</span>)
}
<span class="kw">colMeans</span>(Gini)</code></pre></div>
<pre><code>## [1] 0.016453424 0.001996825 0.001318343</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">decile=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">9</span>,<span class="dv">3</span>)
med=<span class="kw">numeric</span>(<span class="dv">3</span>)
s=<span class="kw">seq.int</span>(<span class="dv">0</span>,m<span class="op">-</span><span class="dv">1</span>,<span class="dt">by=</span>m<span class="op">/</span><span class="dv">10</span>)[<span class="op">-</span><span class="dv">1</span>]
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){
  decile[,i]=<span class="kw">sort</span>(Gini[,i])[s]
  med[i]=<span class="kw">median</span>(Gini[,i])
}
med</code></pre></div>
<pre><code>## [1] 0.014959948 0.001995718 0.001313210</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">decile</code></pre></div>
<pre><code>##             [,1]        [,2]        [,3]
##  [1,] 0.01040535 0.001946957 0.001275480
##  [2,] 0.01166070 0.001967294 0.001287525
##  [3,] 0.01268030 0.001978103 0.001297416
##  [4,] 0.01381037 0.001987204 0.001305003
##  [5,] 0.01495962 0.001995666 0.001313178
##  [6,] 0.01616142 0.002004997 0.001324016
##  [7,] 0.01783330 0.002015924 0.001333911
##  [8,] 0.02006418 0.002026961 0.001345563
##  [9,] 0.02433156 0.002044281 0.001367144</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Gini[,<span class="dv">1</span>],<span class="dt">freq=</span>F)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Gini[,<span class="dv">2</span>],<span class="dt">freq=</span>F)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Gini[,<span class="dv">3</span>],<span class="dt">freq=</span>F)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>6.10 Construct an approximate 95% confidence interval for the Gini ratio <span class="math inline">\(\gamma=E[G]\)</span> if <span class="math inline">\(X\)</span> is lognormal with unknown parameters. Assess the coverage rate of the estimation procedure with a Monte Carlo experiment</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Giniratio=<span class="cf">function</span>(n,distribution){
  <span class="cf">if</span>(distribution<span class="op">==</span><span class="st">&quot;lognormal&quot;</span>) {
    x=<span class="kw">exp</span>(<span class="kw">rnorm</span>(n))
  }
  <span class="cf">if</span>(distribution<span class="op">==</span><span class="st">&quot;uniform&quot;</span>) {
    x=<span class="kw">runif</span>(n)
  }
  <span class="cf">if</span>(distribution<span class="op">==</span><span class="st">&quot;Bernoulli&quot;</span>) {
    x=<span class="kw">rbinom</span>(n,<span class="dt">size=</span><span class="dv">1000</span>,<span class="fl">0.1</span>)
  }
  xorder=<span class="kw">sort</span>(x)
  G=<span class="dv">0</span>
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    G=(<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>xorder[i]
  }
  G=G<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(x))
  <span class="kw">return</span>(G)
}
n=<span class="dv">1000</span>
m=<span class="dv">1000</span>
Gini=<span class="kw">numeric</span>(m)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  Gini[i]=<span class="kw">Giniratio</span>(<span class="dt">n=</span>n,<span class="dt">distribution=</span><span class="st">&quot;lognormal&quot;</span>)
}
CI=<span class="kw">c</span>(<span class="kw">mean</span>(Gini)<span class="op">-</span><span class="kw">qt</span>(<span class="fl">0.975</span>,<span class="fl">1e4</span><span class="op">-</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sd</span>(Gini),<span class="kw">mean</span>(Gini)<span class="op">+</span><span class="kw">qt</span>(<span class="fl">0.975</span>,<span class="fl">1e4</span><span class="op">-</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sd</span>(Gini))
CI</code></pre></div>
<pre><code>## [1] 0.00277584 0.03015684</code></pre>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>6.B Tests for association based on Pearson product moment correlation <span class="math inline">\(\rho\)</span>, Spearman’s rank correlation coefficient <span class="math inline">\(\rho_{s}\)</span>, or Kendall’s coefficient <span class="math inline">\(\tau\)</span>, are implemented in cor.test. Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_{s}\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the correlation test when the sampled distribution is bivariate normal. Find an example of an alternative (a bivariate distribution <span class="math inline">\((X,Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mvtnorm)
test=<span class="cf">function</span>(method,r){
n=<span class="dv">100</span>
m=<span class="dv">1000</span>
mean=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)
sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,r,r,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>)
p=<span class="kw">mean</span>(<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{
x=<span class="kw">rmvnorm</span>(n,mean,sigma)
<span class="kw">cor.test</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>],<span class="dt">method=</span>method)<span class="op">$</span>p.value<span class="op">&lt;=</span><span class="fl">0.05</span>
}))
<span class="kw">return</span>(p)
}
test1=<span class="cf">function</span>(method){             ##(X,Y)~(X,v*X),  X~N(0,1),P(V=1)=P(V=-1)=0.5
n=<span class="dv">100</span>
m=<span class="dv">1000</span>
p=<span class="kw">mean</span>(<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{
x=<span class="kw">rnorm</span>(n)
a=<span class="kw">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.5</span>)
v=<span class="dv">2</span><span class="op">*</span>a<span class="op">-</span><span class="dv">1</span>
y=<span class="kw">data.frame</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>v<span class="op">*</span>x)
<span class="kw">cor.test</span>(y[,<span class="dv">1</span>],y[,<span class="dv">2</span>],<span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)<span class="op">$</span>p.value<span class="op">&lt;=</span><span class="fl">0.05</span>
}))
<span class="kw">return</span>(p)
}
<span class="kw">test</span>(<span class="st">&quot;pearson&quot;</span>,<span class="fl">0.2</span>)</code></pre></div>
<pre><code>## [1] 0.532</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test</span>(<span class="st">&quot;kendall&quot;</span>,<span class="fl">0.2</span>)</code></pre></div>
<pre><code>## [1] 0.458</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test</span>(<span class="st">&quot;spearman&quot;</span>,<span class="fl">0.2</span>)</code></pre></div>
<pre><code>## [1] 0.447</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test1</span>(<span class="st">&quot;pearson&quot;</span>)</code></pre></div>
<pre><code>## [1] 0.235</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test1</span>(<span class="st">&quot;kendall&quot;</span>)</code></pre></div>
<pre><code>## [1] 0.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test1</span>(<span class="st">&quot;spearman&quot;</span>)</code></pre></div>
<pre><code>## [1] 0.228</code></pre>
</div>
<div id="section-4" class="section level2">
<h2>2018-11-2</h2>
</div>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>7.1 Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap) <span class="co">#for the law data</span>
law</code></pre></div>
<pre><code>##    LSAT  GPA
## 1   576 3.39
## 2   635 3.30
## 3   558 2.81
## 4   578 3.03
## 5   666 3.44
## 6   580 3.07
## 7   555 3.00
## 8   661 3.43
## 9   651 3.36
## 10  605 3.13
## 11  653 3.12
## 12  575 2.74
## 13  545 2.76
## 14  572 2.88
## 15  594 2.96</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">theta.hat=<span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)
theta.hat</code></pre></div>
<pre><code>## [1] 0.7763745</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="kw">nrow</span>(law)
j.cor=<span class="cf">function</span>(x,i)<span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])
theta.jack=<span class="kw">numeric</span>(n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  theta.jack[i]=<span class="kw">j.cor</span>(law,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])
}
bias.jack=(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)
bias.jack</code></pre></div>
<pre><code>## [1] -0.006473623</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">se.jack=<span class="kw">sd</span>(theta.jack)<span class="op">*</span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n)
se.jack</code></pre></div>
<pre><code>## [1] 0.1425186</code></pre>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>7.5 Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/ \lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)
aircondit</code></pre></div>
<pre><code>##    hours
## 1      3
## 2      5
## 3      7
## 4     18
## 5     43
## 6     85
## 7     91
## 8     98
## 9    100
## 10   130
## 11   230
## 12   487</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b.mean=<span class="cf">function</span>(x,i)<span class="kw">mean</span>(x[i])
mean.boot=<span class="kw">boot</span>(<span class="dt">data=</span>aircondit<span class="op">$</span>hours,<span class="dt">statistic=</span>b.mean,<span class="dt">R=</span><span class="dv">1000</span>)
mean.boot</code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = aircondit$hours, statistic = b.mean, R = 1000)
## 
## 
## Bootstrap Statistics :
##     original  bias    std. error
## t1* 108.0833   -0.08    38.70203</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CI=<span class="kw">boot.ci</span>(mean.boot,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))
CI</code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = mean.boot, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 32.3, 184.0 )   ( 19.3, 168.7 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.4, 196.8 )   ( 57.7, 247.4 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>The CIs of mean time between failures <span class="math inline">\(1/ \lambda\)</span> from left to right are basic, standard normal, percentile and BCa methods. We can find the times between failures has a right-biased distribution. The quantiles are left compared to the normal distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(aircondit<span class="op">$</span>hours,<span class="dt">breaks =</span> <span class="dv">50</span>,<span class="dt">freq =</span> F)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3</h2>
<p>7.8 Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>The MLE of <span class="math inline">\(\Sigma\)</span> is sample covariance matrix <span class="math inline">\(\Sigma_{sample}\)</span> multiplied by <span class="math inline">\(\frac{n-1}{n}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
scor</code></pre></div>
<pre><code>##    mec vec alg ana sta
## 1   77  82  67  67  81
## 2   63  78  80  70  81
## 3   75  73  71  66  81
## 4   55  72  63  70  68
## 5   63  63  65  70  63
## 6   53  61  72  64  73
## 7   51  67  65  65  68
## 8   59  70  68  62  56
## 9   62  60  58  62  70
## 10  64  72  60  62  45
## 11  52  64  60  63  54
## 12  55  67  59  62  44
## 13  50  50  64  55  63
## 14  65  63  58  56  37
## 15  31  55  60  57  73
## 16  60  64  56  54  40
## 17  44  69  53  53  53
## 18  42  69  61  55  45
## 19  62  46  61  57  45
## 20  31  49  62  63  62
## 21  44  61  52  62  46
## 22  49  41  61  49  64
## 23  12  58  61  63  67
## 24  49  53  49  62  47
## 25  54  49  56  47  53
## 26  54  53  46  59  44
## 27  44  56  55  61  36
## 28  18  44  50  57  81
## 29  46  52  65  50  35
## 30  32  45  49  57  64
## 31  30  69  50  52  45
## 32  46  49  53  59  37
## 33  40  27  54  61  61
## 34  31  42  48  54  68
## 35  36  59  51  45  51
## 36  56  40  56  54  35
## 37  46  56  57  49  32
## 38  45  42  55  56  40
## 39  42  60  54  49  33
## 40  40  63  53  54  25
## 41  23  55  59  53  44
## 42  48  48  49  51  37
## 43  41  63  49  46  34
## 44  46  52  53  41  40
## 45  46  61  46  38  41
## 46  40  57  51  52  31
## 47  49  49  45  48  39
## 48  22  58  53  56  41
## 49  35  60  47  54  33
## 50  48  56  49  42  32
## 51  31  57  50  54  34
## 52  17  53  57  43  51
## 53  49  57  47  39  26
## 54  59  50  47  15  46
## 55  37  56  49  28  45
## 56  40  43  48  21  61
## 57  35  35  41  51  50
## 58  38  44  54  47  24
## 59  43  43  38  34  49
## 60  39  46  46  32  43
## 61  62  44  36  22  42
## 62  48  38  41  44  33
## 63  34  42  50  47  29
## 64  18  51  40  56  30
## 65  35  36  46  48  29
## 66  59  53  37  22  19
## 67  41  41  43  30  33
## 68  31  52  37  27  40
## 69  17  51  52  35  31
## 70  34  30  50  47  36
## 71  46  40  47  29  17
## 72  10  46  36  47  39
## 73  46  37  45  15  30
## 74  30  34  43  46  18
## 75  13  51  50  25  31
## 76  49  50  38  23   9
## 77  18  32  31  45  40
## 78   8  42  48  26  40
## 79  23  38  36  48  15
## 80  30  24  43  33  25
## 81   3   9  51  47  40
## 82   7  51  43  17  22
## 83  15  40  43  23  18
## 84  15  38  39  28  17
## 85   5  30  44  36  18
## 86  12  30  32  35  21
## 87   5  26  15  20  20
## 88   0  40  21   9  14</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="kw">nrow</span>(scor)
sigma.hat=<span class="kw">cov</span>(scor)<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n
eigenvalues.hat=<span class="kw">eigen</span>(sigma.hat)<span class="op">$</span>values
theta.hat=eigenvalues.hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(eigenvalues.hat)
theta.jack=<span class="kw">numeric</span>(n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  sigma.jack=<span class="kw">cov</span>(scor[<span class="op">-</span>i,])<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n
  eigenvalues.jack=<span class="kw">eigen</span>(sigma.jack)<span class="op">$</span>values
  theta.jack[i]=eigenvalues.jack[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(eigenvalues.jack)
}
bias.jack=(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)
bias.jack</code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">se.jack=<span class="kw">sd</span>(theta.jack)<span class="op">*</span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n)
se.jack</code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>7.11 In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG) </code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：'lattice'</code></pre>
<pre><code>## The following object is masked from 'package:boot':
## 
##     melanoma</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(ironslag)
a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, .<span class="dv">1</span>) <span class="co">#sequence for plotting fits</span>

L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a
<span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>
<span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAb1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OpA6kNtmAABmADpmZmZmkJBmtrZmtv+QOgCQtpCQ29uQ2/+2ZgC2Zma225C2/9u2///bkDrb2//b/7bb////tmb/25D//7b//9v///+1NLW2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAALj0lEQVR4nO2djZbjJhKF1b1jZ5PYSbY7GWW3tTuy2+//jCt+jSTgAgKB23XPmWlZKhfiMxRILqPuRvKqq30CrYsAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQED1AI0d01uAZd+9ftiP/P1x+3zvvv3IemJz1QJ0PXdCrrobcgG6nl+/LKCpWl0wIRcgd8vKqEqABtm7LseuO6mqTq3qJPd1L9+5Xc+2+NGhe/nzyHbrwz3H+x/ZgsbQDhupOoCmBiQJTFCm+pmARGzix3U744CYvv24H54B6sXuU/ZTrQNoQnGQm72oqwY0QTnwViRYHXjdBSAGwjzM3yVi0MjYTO/P3+fqABIV5BoWgOROiUbuFoB0BzIPC0DCcigQk9oDpPrVQbYWCWKQnfJ+2ABUcCir2sUGDmGqpQDEsXEAb9xAdUQTkHF4DujgLzFZNYP0VM2Xn7t7D+GAROPiBFS7MAEZh79yC5LDvJgtnmQ/E5F25LHGiMI6BnFAq8NmDBrl0JhTlQDpibQYm4ZOdi7egniLYE1kPoqpFqQP8116FOMtLv9MqPqlBm9BfPIntvXchwWV3pwH3WOQPDyu50H5I1Hti9Xf74S+/U+PYi/fBzGlYfV+W41i6jCbZ/9lzqTzzxMbuN3RF73W3Kz6gBoXAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQKKA6RSB3ZIv21FUYAGlR0wlkgTaFMxgD7fNZah7YyDjIoBdD3r9KTxaTpZ5hbUPYxKAJpikGxCzhjU/qAo2ZQBpBPnnBGoeUCq9RQCtLe77NL9a2dA8V27kvYBdDk6k22fG5CRuuuaS7cOqHAMkoPXA7eg8qMYG78eGpBUsRjU8x9FEiC3pgtWAuTV5fgPAuTV57v7NzWPAqjQtdju7oqJAPlV6mp+d3e4vJSLm3K3O3Z3B4tLuvyrcLFayh0qLekCucbVfCl3qLQUQM90PygFUNlrsb3dweJi+Wj7JwEUPYppc7qjaFVXC1Apd5llfIAEyCKzgacA6vkSD9u+dG8iBjl6+mx3AiDxA//redPqDi2MYo5YON8ZD0h98b7tW/cG5kH20WK5Kx6Q+uJ92zJXDQNavA4uQ28Nct2+TUGoEqBZ+LUAsmAMLuO+aa5fmKo6MWhOxMpn9c7gIqJOCKbgVRnFlm0Gt59SgHAKXpV5EJjE28e0YOcRJxKSQBXhLpv8gOxHIgFdz6eA5XkDUvDqzKTj+TxXC/Jd1LuOJEwUfxPjl2+i+GApeL6elw7IO1F8qBQ8f+QO9iL+qPX4uo0ryTUECITuYDdqQ7WgLSfT1A2z3IDCNXrm218aEF8cvPf2sKknni6//jAH/MRyiwvNHoP96K3x5fs0eE8zIrcxu2XU89bT2DC/FmPj6/FptztYtT2jGG83l5/4oryNTBTnDPQr76WZ2BlcgtpgtWeAPPMg0bo+/3trpgU5LuPBxT3fG1yE2lAtyLe0qm5dzo5Y84aZfjUD4ohFyTFo8K7IPIjha3QatQBo1e1y3e7g0+SHumFmBbSgkRFQDtWPQSsYuWJQHlUfxWwsMt0wy/KL5qrzoJhrnQRAfY6fodYEFHU1mDIPyvFL74qA4i6X0yaK27UbIHssngPKfamR45ELewGyjebLndkvVnM8tGMnQMvG0mk+RgaQt8eldLEufRSzz9HKac3CujMroDyqAUhtESCznBmf9U7Ly4WD4JLUhvGL3Q2xaPdRbBmKbDbW9wcXpLfEd10je7pZ+oyoBCBvPVPDXvowz255pK99UwCQp6dsGBXSJ4rj68eGLLz8gNyxdtOomXZHkYm1oP0A4SpqQHPTrZOKLTFoy5w68pQDaqkArWeGm1pr8h1F9shKdwPKnGEWNLk0+KxvPyerzDwod4ZZWD1VB9Omej4SVdjCaXbDW4H8oGU9PfMYw7QzACVTSgCkZop7Zph5A4v9oAazTm+NKjnesJ+Gr4NvXY4SGWaORmJ5eVuB2dTT0u4ojuyrZ98Xh/kyzCz1AoDMXQ5AEbDSJoqXf37wf05lyzCzffIIkEHEDiimOaVNFFkSlRdQrnKtfcMPaEbGGoOiOlxCU2Pz5/6UtghpbDyIBqQ2zU4m9/udOs8gzGxm2B/kc6fdEs+wvrlTPbMAWrPQxj4IxQFhDfwZ6PxJ8RuHeWtVFv1mxsf7xoBjqSeaMFH8fPekWWUYxe4NwQg6YSNVOJ+yE8XefcG/afZvAdS5AEWw2HaixigGo7OeKPaHPQCJPwtAi26YXli0Ycg3qwqLO5ZvO+lZUF41KG2yblYJZUUbGtcRbqmp9Od7PKCACt27T4OAZPrqRnkDaFCNdOXbA3QUpZbJDwqr0szKGm5m8EqcqNOwcPICrtK6WXS2AaszwlSJE3UaFk5/0VWa17pbjOc+17arimRKhYL0hnLnHcb8E9H7HN6ynqjTMGeQtp34ikhUtF0abu1pKV1MFpchSDswuLRyYqmz1XRXQHk0D7FpgFzQvhoghwGvkQ+Qu1kF7sxzotGGfi/O7mIz9c/3XI6szlP5tNuCpFkCoLxqHJB3mN6DT/OAvMP0DnzqAgqu4D69yV50dsNwd+GVfk5AMbWuxudRAO0SbuwFZzcMdpfSb/bnVAhQUIZZEp+9CZUBFJhhlsRnZ0JFAJVagerLACq1htmXAVRsDbMvFIMKrWFm51OSWqFRbNc1zIq2q+YvVgNcFY1M7d4wi/WZz+Hce3bD3d0RIOjr4WLQ3s9ZfbxRzJn1kuaupopdrIIMh+5hVAZQ4PIMIU4z2eQqqsybtzglQPvYEKCdiirz5i1OCdA+NgRop6LKvHmLUwK0j81jAvpKIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERIKDcgOTqOqPvCR3CRnwNaf0aiadCnrx+tInHDVuLRT0pJfmBIZkBXc/8q8VxOp3RdUrSxv0Lx8/36a0Dq7TTz93E80NJtg4Cf7f3dIDyAhrFd9IiFa23f6zSxvOUJbGO2lQ9tx9t4nHDF+1lX3V6TwcpK6CxO/HzvZ++2+Y2gBOePnKfH2mC3DBAyI1XuWOQAOR9Bpk80P/SeZ842b9+AD98zVDghi15hNx4VQSQ6O/OXs9trmeWx+d+YiBLg0R+JhO/m5GzA278qgZotbmwUTHa7We8j13u1sFW/WkPUFAX43KtaynSaL1+zExbz/KYLJQ118VAVDQB2Qdp+ZsHn5/BDDyesX7y0V6QBuOqAdH+sd6XKXL6USYeN/pQO8P8TZ2qf2YmRzF2wtboejmqvU4/dxO3G/64Rg6nnYmi/iwH39xe2rDnS1tDxyBywJgDlx/DxOnGOOQ9Hb/oYhWIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERIKCmAPmfDmM9mueBMh49EKBcb4kTAQJqBNDAs+Wv5z+OImFlEKmrl+O/ztPGhe8VLAaZVy9TW54EkHg+6el6ZonP8h/LkboceUL96wdLoOMspCXPmxLbzwCI58Srv5fjm3g9vn7wRDL53xtjoS1/+y5y7J4DkEpS5bWd/hPpcir9Uv3HH9dtpLOO935XUG0AkkmqGpBciM0CSKWzTqHo9d9P3oJudzarFqQPPAegewwSgHStV4CUpUjof5ouxsejz/eDAsRf33r5cx8TkLIUjYf/VuMpAOl5kJrZsNdTI1kDUvMgntg7IXwWQO2KAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBA/wdkMV5gp4r1bgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a
yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)
<span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(chemical))
<span class="kw">plot</span>(<span class="kw">log</span>(chemical), <span class="kw">log</span>(magnetic), <span class="dt">main=</span><span class="st">&quot;Log-Log&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
logyhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(a)
<span class="kw">lines</span>(<span class="kw">log</span>(a), logyhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span>
e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">/</span><span class="dv">2</span>) <span class="co">#store the mean of squared residual for leave-two-out samples point</span>
<span class="co"># for n/2-fold(leave-two-out) cross validation</span>
<span class="co"># fit models on leave-two-out samples</span>
<span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)) {
index&lt;-<span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="op">*</span>k)  <span class="co">#Subscript of leave-two-out samples point</span>
y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>index]
x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>index]

J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[index]
e1[k] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[index] <span class="op">-</span><span class="st"> </span>yhat1)<span class="op">^</span><span class="dv">2</span>)

J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[index] <span class="op">+</span>
J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[index]<span class="op">^</span><span class="dv">2</span>
e2[k] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[index] <span class="op">-</span><span class="st"> </span>yhat2)<span class="op">^</span><span class="dv">2</span>)

J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[index]
yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)
e3[k] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[index] <span class="op">-</span><span class="st"> </span>yhat3)<span class="op">^</span><span class="dv">2</span>)

J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))
logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[index])
yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)
e4[k] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[index] <span class="op">-</span><span class="st"> </span>yhat4)<span class="op">^</span><span class="dv">2</span>)
}
<span class="kw">c</span>(<span class="kw">mean</span>(e1), <span class="kw">mean</span>(e2), <span class="kw">mean</span>(e3), <span class="kw">mean</span>(e4))</code></pre></div>
<pre><code>## [1] 19.26253 17.35040 17.70556 19.81362</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L2</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
</div>
<div id="section-5" class="section level2">
<h2>2018-11-16</h2>
<p>Q1: 8.1 Implement the two-sample Cramer-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2.</p>
<p>A1:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="kw">attach</span>(chickwts)
x &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;soybean&quot;</span>]))
y &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>]))
<span class="kw">detach</span>(chickwts)
x</code></pre></div>
<pre><code>##  [1] 158 171 193 199 230 243 248 248 250 267 271 316 327 329</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y</code></pre></div>
<pre><code>##  [1] 141 148 169 181 203 213 229 244 257 260 271 309</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CMtest&lt;-<span class="cf">function</span>(S1, S2){
  xS1=<span class="kw">sort</span>(S1)
  M=<span class="kw">length</span>(xS1)
  xS2=<span class="kw">sort</span>(S2)
  N=<span class="kw">length</span>(xS2)
  
  a=<span class="kw">data.frame</span>(<span class="dt">val=</span>xS1,<span class="dt">rang=</span><span class="kw">seq</span>(M),<span class="dt">ens=</span><span class="kw">rep</span>(<span class="dv">1</span>,M))
  b=<span class="kw">data.frame</span>(<span class="dt">val=</span>xS2,<span class="dt">rang=</span><span class="kw">seq</span>(N),<span class="dt">ens=</span><span class="kw">rep</span>(<span class="dv">2</span>,N))
  c=<span class="kw">rbind</span>(a,b)
  c=c[<span class="kw">order</span>(c<span class="op">$</span>val),]
  c=<span class="kw">data.frame</span>(c,<span class="dt">rangTot=</span><span class="kw">seq</span>(M<span class="op">+</span>N))
  dtfM=c[<span class="kw">which</span>(c<span class="op">$</span>ens<span class="op">==</span><span class="dv">1</span>),]
  dtfN=c[<span class="kw">which</span>(c<span class="op">$</span>ens<span class="op">==</span><span class="dv">2</span>),]
  somN =<span class="st"> </span><span class="kw">sum</span>( (dtfN<span class="op">$</span>rang <span class="op">-</span><span class="st"> </span>dtfN<span class="op">$</span>rangTot)<span class="op">**</span><span class="dv">2</span> )
  somM =<span class="st"> </span><span class="kw">sum</span>( (dtfM<span class="op">$</span>rang <span class="op">-</span><span class="st"> </span>dtfM<span class="op">$</span>rangTot)<span class="op">**</span><span class="dv">2</span> )
  U =<span class="st"> </span>N<span class="op">*</span>somN <span class="op">+</span><span class="st"> </span>M<span class="op">*</span>somM
  CvM =<span class="st"> </span>(  (U <span class="op">/</span><span class="st"> </span>(N<span class="op">*</span>M)) <span class="op">/</span><span class="st"> </span>(N<span class="op">+</span>M) ) <span class="op">-</span><span class="st"> </span>((<span class="dv">4</span><span class="op">*</span>M<span class="op">*</span>N <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">6</span><span class="op">*</span>(M<span class="op">+</span>N)))
  <span class="kw">return</span>(CvM)
}
R &lt;-<span class="st"> </span><span class="dv">999</span>
z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)
K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(z)
n&lt;-<span class="kw">length</span>(x)
reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)
t0 &lt;-<span class="st"> </span><span class="kw">CMtest</span>(x, y)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {
  kn &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)
  x1 &lt;-<span class="st"> </span>z[kn]
  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>kn]
  reps[i] &lt;-<span class="st"> </span><span class="kw">CMtest</span>(x1, y1)
}
p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0, reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0))
p</code></pre></div>
<pre><code>## [1] 0.429</code></pre>
<p>The p-value does not support the alternative hypothesis that distributions differ.</p>
<p>Q2: Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations 1 Unequal variances and equal expectations 2 Unequal variances and unequal expectations 3 Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) 4 Unbalanced samples (say, 1 case versus 10 controls) 5 Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<p>A2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># library(RANN)</span>
<span class="co"># library(boot)</span>
<span class="co"># library(energy)</span>
<span class="co"># library(Ball)</span>
<span class="co"># </span>
<span class="co"># m &lt;- 1e3; k&lt;-3; p&lt;-2; mu &lt;- 0.5; su &lt;- 0.75; set.seed(12)</span>
<span class="co"># n1 &lt;- n2 &lt;- 50; R&lt;-999; n &lt;- n1+n2; N = c(n1,n2)</span>
<span class="co"># n3 &lt;- 10; n4 &lt;-100  #Unbalanced samples</span>
<span class="co"># </span>
<span class="co"># Tn &lt;- function(z, ix, sizes,k) {</span>
<span class="co">#    n1 &lt;- sizes[1]; n2 &lt;- sizes[2]; n &lt;- n1 + n2</span>
<span class="co">#    if(is.vector(z)) z &lt;- data.frame(z,0);</span>
<span class="co">#    z &lt;- z[ix, ];</span>
<span class="co">#    NN &lt;- nn2(data=z, k=k+1) # what's the first column?</span>
<span class="co">#    block1 &lt;- NN$nn.idx[1:n1,-1]</span>
<span class="co">#    block2 &lt;- NN$nn.idx[(n1+1):n,-1]</span>
<span class="co">#    i1 &lt;- sum(block1 &lt; n1 + .5); i2 &lt;- sum(block2 &gt; n1+.5)</span>
<span class="co">#    (i1 + i2) / (k * n)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># eqdist.nn &lt;- function(z,sizes,k){</span>
<span class="co">#   boot.obj &lt;- boot(data=z,statistic=Tn,R=R,</span>
<span class="co">#   sim = &quot;permutation&quot;, sizes = sizes,k=k)</span>
<span class="co">#   ts &lt;- c(boot.obj$t0,boot.obj$t)</span>
<span class="co">#   p.value &lt;- mean(ts&gt;=ts[1])</span>
<span class="co">#   list(statistic=ts[1],p.value=p.value)</span>
<span class="co"># }</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Unequal variances and equal expectations</span>
<span class="co"># p.values1 &lt;- matrix(NA,m,3)</span>
<span class="co"># for(i in 1:m){</span>
<span class="co">#   x &lt;- matrix(rnorm(n1*p),ncol=p);</span>
<span class="co">#   y &lt;- cbind(rnorm(n2),rnorm(n2,sd=su));</span>
<span class="co">#   z &lt;- rbind(x,y)</span>
<span class="co">#   p.values1[i,1] &lt;- eqdist.nn(z,N,k)$p.value</span>
<span class="co">#   p.values1[i,2] &lt;- eqdist.etest(z,sizes=N,R=R)$p.value</span>
<span class="co">#   p.values1[i,3] &lt;- bd.test(x=x,y=y,R=999,seed=i*12)$p.value</span>
<span class="co"># }</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># #Unequal variances and unequal expectations</span>
<span class="co"># p.values2 &lt;- matrix(NA,m,3)</span>
<span class="co"># for(i in 1:m){</span>
<span class="co">#   x &lt;- matrix(rnorm(n1*p),ncol=p);</span>
<span class="co">#   y &lt;- cbind(rnorm(n2),rnorm(n2,mean=mu,sd=su));</span>
<span class="co">#   z &lt;- rbind(x,y)</span>
<span class="co">#   p.values2[i,1] &lt;- eqdist.nn(z,N,k)$p.value</span>
<span class="co">#   p.values2[i,2] &lt;- eqdist.etest(z,sizes=N,R=R)$p.value</span>
<span class="co">#   p.values2[i,3] &lt;- bd.test(x=x,y=y,R=999,seed=i*12)$p.value</span>
<span class="co"># }</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># #t distribution with 1 df (heavy-tailed distribution)</span>
<span class="co"># p.values3 &lt;- matrix(NA,m,3)</span>
<span class="co"># for(i in 1:m){</span>
<span class="co">#   x &lt;- matrix(rt(n1*p,df=1),ncol=p);</span>
<span class="co">#   y &lt;- cbind(rt(n2,df=1),rt(n2,df=1));</span>
<span class="co">#   z &lt;- rbind(x,y)</span>
<span class="co">#   p.values3[i,1] &lt;- eqdist.nn(z,N,k)$p.value</span>
<span class="co">#   p.values3[i,2] &lt;- eqdist.etest(z,sizes=N,R=R)$p.value</span>
<span class="co">#   p.values3[i,3] &lt;- bd.test(x=x,y=y,R=999,seed=i*12)$p.value</span>
<span class="co"># }</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># #Unbalanced samples (say, 1 case versus 10 controls)</span>
<span class="co"># p.values4 &lt;- matrix(NA,m,3)</span>
<span class="co"># for(i in 1:m){</span>
<span class="co">#   x &lt;- matrix(rnorm(n3*p),ncol=p);</span>
<span class="co">#   y &lt;- cbind(rnorm(n4),rnorm(n4,mean = mu));</span>
<span class="co">#   z &lt;- rbind(x,y)</span>
<span class="co">#   p.values4[i,1] &lt;- eqdist.nn(z,N,k)$p.value</span>
<span class="co">#   p.values4[i,2] &lt;- eqdist.etest(z,sizes=c(n3,n4),R=R)$p.value</span>
<span class="co">#   p.values4[i,3] &lt;- bd.test(x=x,y=y,R=999,seed=i*12)$p.value</span>
<span class="co"># }</span>
<span class="co"># alpha &lt;- 0.1;</span>
<span class="co"># pow1 &lt;- colMeans(p.values1&lt;alpha)</span>
<span class="co"># pow2 &lt;- colMeans(p.values2&lt;alpha)</span>
<span class="co"># pow3 &lt;- colMeans(p.values3&lt;alpha)</span>
<span class="co"># pow4 &lt;- colMeans(p.values4&lt;alpha)</span>
<span class="co"># pow1</span>
<span class="co"># pow2</span>
<span class="co"># pow3</span>
<span class="co"># pow4</span></code></pre></div>
<p>Q3: 9.3 Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy(<span class="math inline">\(\theta, \eta\)</span>) distribution has density function <span class="math display">\[ f(x)=\frac{1}{\theta\pi(1+((x-\eta)/\theta)^2)} ,-\infty&lt;x&lt;\infty, \theta&gt;0  \]</span> The standard Cauchy has the Cauchy(<span class="math inline">\(\theta = 1, \eta = 0\)</span>) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
<p>A3: Using random walk Metropolis method, proposal distribution <span class="math inline">\(g(|X)\)</span> is <span class="math inline">\(N(X,\sigma^2)\)</span>. We can generate random variables from a standard Cauchy distribution(<span class="math inline">\(t_1\)</span> distribution) as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(n, sigma, x0, N) {
        x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)
        x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0
        u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)
        k &lt;-<span class="st"> </span><span class="dv">0</span>
        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {
            y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="op">-</span><span class="dv">1</span>], sigma)
                <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dt</span>(y, n) <span class="op">/</span><span class="st"> </span><span class="kw">dt</span>(x[i<span class="op">-</span><span class="dv">1</span>], n)))
                x[i] &lt;-<span class="st"> </span>y  <span class="cf">else</span> {
                    x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
                    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
                }
            }
        <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))
        }

    n &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co">#degrees of freedom for target Student t dist.</span>
    N &lt;-<span class="st"> </span><span class="dv">5000</span>
    sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>,  <span class="dv">16</span>)

    x0 &lt;-<span class="st"> </span><span class="dv">25</span>
    rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">1</span>], x0, N)
    rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">2</span>], x0, N)
    rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">3</span>], x0, N)
    rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">4</span>], x0, N)

    <span class="co">#number of candidate points rejected</span>
    <span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</code></pre></div>
<pre><code>## [1]    2  570 1850 4008</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    <span class="co"># par(mfrow=c(2,2))  </span>
     refline &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="kw">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="dt">df=</span>n)
    rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)
    <span class="co"># for (j in 1:4) {</span>
    <span class="co">#     plot(rw[,j], type=&quot;l&quot;,</span>
    <span class="co">#          xlab=bquote(sigma == .(round(sigma[j],3))),</span>
    <span class="co">#          ylab=&quot;X&quot;, ylim=range(rw[,j]))</span>
    <span class="co">#     abline(h=refline)</span>
    <span class="co"># }</span>
    <span class="co"># par(mfrow=c(1,1)) #reset to default</span>
    
    Nd=<span class="dv">1000</span>  <span class="co">#number of discarded sample</span>
    a &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), .<span class="dv">95</span>)
    Q &lt;-<span class="st"> </span><span class="kw">qt</span>(a, n)
    mc &lt;-<span class="st"> </span>rw[(Nd<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N, ]
    Qrw &lt;-<span class="st"> </span><span class="kw">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, a))
    knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(Q, Qrw),<span class="dt">col.names=</span><span class="kw">c</span>(<span class="st">&quot;True&quot;</span>,<span class="st">&quot;sigma=0.05&quot;</span>,<span class="st">&quot;sigma=0.5&quot;</span>,<span class="st">&quot;sigma=2&quot;</span>,<span class="st">&quot;sigma=16&quot;</span>)) </code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">True</th>
<th align="right">sigma=0.05</th>
<th align="right">sigma=0.5</th>
<th align="right">sigma=2</th>
<th align="right">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5%</td>
<td align="right">-6.3137515</td>
<td align="right">23.01039</td>
<td align="right">-2.4848951</td>
<td align="right">-3.1535294</td>
<td align="right">-5.0056886</td>
</tr>
<tr class="even">
<td>10%</td>
<td align="right">-3.0776835</td>
<td align="right">23.42277</td>
<td align="right">-1.8096891</td>
<td align="right">-1.9570462</td>
<td align="right">-2.9772652</td>
</tr>
<tr class="odd">
<td>20%</td>
<td align="right">-1.3763819</td>
<td align="right">24.26085</td>
<td align="right">-1.0955572</td>
<td align="right">-1.0068177</td>
<td align="right">-1.4436308</td>
</tr>
<tr class="even">
<td>30%</td>
<td align="right">-0.7265425</td>
<td align="right">24.49980</td>
<td align="right">-0.6711062</td>
<td align="right">-0.5540655</td>
<td align="right">-0.8386742</td>
</tr>
<tr class="odd">
<td>40%</td>
<td align="right">-0.3249197</td>
<td align="right">24.73211</td>
<td align="right">-0.3759953</td>
<td align="right">-0.2411388</td>
<td align="right">-0.4109234</td>
</tr>
<tr class="even">
<td>50%</td>
<td align="right">0.0000000</td>
<td align="right">24.99545</td>
<td align="right">-0.0844697</td>
<td align="right">0.0721570</td>
<td align="right">-0.0742546</td>
</tr>
<tr class="odd">
<td>60%</td>
<td align="right">0.3249197</td>
<td align="right">25.25731</td>
<td align="right">0.1820237</td>
<td align="right">0.3711679</td>
<td align="right">0.3833099</td>
</tr>
<tr class="even">
<td>70%</td>
<td align="right">0.7265425</td>
<td align="right">25.81161</td>
<td align="right">0.4640245</td>
<td align="right">0.7555479</td>
<td align="right">0.8524043</td>
</tr>
<tr class="odd">
<td>80%</td>
<td align="right">1.3763819</td>
<td align="right">26.12962</td>
<td align="right">0.8424853</td>
<td align="right">1.4292589</td>
<td align="right">1.4797326</td>
</tr>
<tr class="even">
<td>90%</td>
<td align="right">3.0776835</td>
<td align="right">26.52343</td>
<td align="right">1.5127635</td>
<td align="right">3.7061803</td>
<td align="right">2.7548344</td>
</tr>
<tr class="odd">
<td>95%</td>
<td align="right">6.3137515</td>
<td align="right">27.33534</td>
<td align="right">2.1534105</td>
<td align="right">8.4967479</td>
<td align="right">4.5320826</td>
</tr>
<tr class="even">
<td>We can</td>
<td align="right">find the gre</td>
<td align="right">atter $</td>
<td align="right">^2$ has bette</td>
<td align="right">r performance</td>
<td align="right">.</td>
</tr>
</tbody>
</table>
<p>Q4: 9.6 Rao [220, Sec. 5g] presented an example on genetic linkage of 197 animals in four categories (also discussed in [67, 106, 171, 266]). The group sizes are (125, 18, 20, 34). Assume that the probabilities of the corresponding multinomial distribution are <span class="math display">\[  (\frac{1}{2}+\frac{\theta}{4},\frac{1-\theta}{4},\frac{1-\theta}{4},\frac{\theta}{4}) \]</span> Estimate the posterior distribution of <span class="math inline">\(\theta\)</span> given the observed sample, using one of the methods in this chapter.</p>
<p>A4: The multinomial joint distribution of <span class="math inline">\(X1, \cdots, X4\)</span> has the probability vector <span class="math display">\[ p=(\frac{1}{2}+\frac{\theta}{4},\frac{1-\theta}{4},\frac{1-\theta}{4},\frac{\theta}{4})  \]</span>. The posterior distribution of <span class="math inline">\(\theta\)</span> given <span class="math inline">\((x1,\cdots, x4)=(125, 18, 20, 34)\)</span> is therefore <span class="math display">\[  p(\theta|(x1,\cdots, x4))= \frac{197!}{x1!x2!x3!x4!}p_1^{x1}p_2^{x2}p_3^{x3}p_4^{x4} \]</span>. Notice that <span class="math inline">\(0&lt;\theta&lt;1\)</span>. The proposal distribution is uniform distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12</span>)
Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {
        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span>
        <span class="co"># for chain in i-th row of X</span>
        psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)
        n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)
        k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)

        psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span>
        B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span>
        psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span>
        W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span>
        v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span>
        r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span>
        <span class="kw">return</span>(r.hat)
}

size&lt;-<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
prob &lt;-<span class="st"> </span><span class="cf">function</span>(y, size) {
        <span class="co"># computes (without the constant) the target density</span>
        <span class="cf">if</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>)
            <span class="kw">return</span> (<span class="dv">0</span>)
        <span class="kw">return</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">1</span>] <span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">3</span>] <span class="op">*</span>(y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">4</span>])
}

thetachain&lt;-<span class="cf">function</span>(m){ <span class="co">#generate a Metropolis chain for theta</span>
w&lt;-<span class="fl">0.5</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)  <span class="co">#for accept/reject step</span>
v&lt;-<span class="kw">runif</span>(m,<span class="op">-</span>w,w) <span class="co">#proposal distribution</span>
x&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,m)
x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.5</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
    y &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span>v[i] 
    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">prob</span>(y, size) <span class="op">/</span><span class="st"> </span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>], size))
        x[i] &lt;-<span class="st"> </span>y  <span class="cf">else</span>
   x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
}
<span class="kw">return</span>(x)
}
<span class="co">#generate the chains</span>
k=<span class="dv">4</span>      <span class="co">#number of chains to generate</span>
n=<span class="dv">15000</span>  <span class="co">#length of chains</span>
b=<span class="dv">1000</span>   <span class="co">#burn-in length</span>
theta &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) 
  theta[i, ] &lt;-<span class="st"> </span><span class="kw">thetachain</span>(<span class="dt">m=</span>n)
<span class="co">#compute diagnostic statistics</span>
psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(theta, <span class="dv">1</span>, cumsum))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) 
  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))
<span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</code></pre></div>
<pre><code>## [1] 1.05677</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot psi for the four chains</span>
<span class="co">#par(mfrow=c(2,2))</span>
<span class="co">#for (i in 1:k)</span>
<span class="co">#plot(psi[i, (b+1):n], type=&quot;l&quot;,xlab=i, ylab=bquote(psi))</span>
<span class="co">#par(mfrow=c(1,1)) #restore default</span>
<span class="co">#the sequence of R-hat statistics</span>
rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)
<span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)
rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])
<span class="co">#plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;)</span>
<span class="co">#abline(h=1.2, lty=2)</span></code></pre></div>
<p>The chain has approximately converged to the target distribution within approximately 2000 iterations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#par(mfrow=c(2,2))</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)
<span class="co">#hist(psi[i, 2001:n],xlab=i,freq=FALSE)</span>
<span class="co">#par(mfrow=c(1,1)) #restore default</span>
theta=<span class="kw">rowMeans</span>(psi[,<span class="dv">2001</span><span class="op">:</span>n]) 
<span class="co">#estimation of theta </span>
<span class="kw">mean</span>(theta)</code></pre></div>
<pre><code>## [1] 0.6233276</code></pre>
</div>
<div id="section-6" class="section level2">
<h2>2018-11-23</h2>
<p>Q1: 9.6 Rao [220, Sec. 5g] presented an example on genetic linkage of 197 animals in four categories (also discussed in [67, 106, 171, 266]). The group sizes are (125, 18, 20, 34). Assume that the probabilities of the corresponding multinomial distribution are <span class="math display">\[  (\frac{1}{2}+\frac{\theta}{4},\frac{1-\theta}{4},\frac{1-\theta}{4},\frac{\theta}{4}) \]</span> Estimate the posterior distribution of <span class="math inline">\(\theta\)</span> given the observed sample, using one of the methods in this chapter. For exercise 9.6, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<p>A1: The multinomial joint distribution of <span class="math inline">\(X1, \cdots, X4\)</span> has the probability vector <span class="math display">\[ p=(\frac{1}{2}+\frac{\theta}{4},\frac{1-\theta}{4},\frac{1-\theta}{4},\frac{\theta}{4})  \]</span>. The posterior distribution of <span class="math inline">\(\theta\)</span> given <span class="math inline">\((x1,\cdots, x4)=(125, 18, 20, 34)\)</span> is therefore <span class="math display">\[  p(\theta|(x1,\cdots, x4))= \frac{197!}{x1!x2!x3!x4!}p_1^{x1}p_2^{x2}p_3^{x3}p_4^{x4} \]</span>. Notice that <span class="math inline">\(0&lt;\theta&lt;1\)</span>. The proposal distribution is uniform distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12</span>)
Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {
        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span>
        <span class="co"># for chain in i-th row of X</span>
        psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)
        n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)
        k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)

        psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span>
        B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span>
        psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span>
        W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span>
        v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span>
        r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span>
        <span class="kw">return</span>(r.hat)
}

size&lt;-<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
prob &lt;-<span class="st"> </span><span class="cf">function</span>(y, size) {
        <span class="co"># computes (without the constant) the target density</span>
        <span class="cf">if</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>)
            <span class="kw">return</span> (<span class="dv">0</span>)
        <span class="kw">return</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">1</span>] <span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">3</span>] <span class="op">*</span>(y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>size[<span class="dv">4</span>])
}

thetachain&lt;-<span class="cf">function</span>(m,x0){ <span class="co">#generate a Metropolis chain for theta</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)  <span class="co">#for accept/reject step</span>
x&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,m)
x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
    y &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) 
    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">prob</span>(y, size) <span class="op">/</span><span class="st"> </span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>], size))
        x[i] &lt;-<span class="st"> </span>y  <span class="cf">else</span>
   x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
}
<span class="kw">return</span>(x)
}
<span class="co">#generate the chains</span>
k=<span class="dv">4</span>      <span class="co">#number of chains to generate</span>
n=<span class="dv">15000</span>  <span class="co">#length of chains</span>
b=<span class="dv">1000</span>   <span class="co">#burn-in length</span>
x0=<span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>)
theta &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) 
  theta[i, ] &lt;-<span class="st"> </span><span class="kw">thetachain</span>(<span class="dt">m=</span>n,<span class="dt">x0=</span>x0[i])
<span class="co">#compute diagnostic statistics</span>
psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(theta, <span class="dv">1</span>, cumsum))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) 
  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))
<span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</code></pre></div>
<pre><code>## [1] 1.124801</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot psi for the four chains</span>
<span class="co">#par(mfrow=c(2,2))</span>
<span class="co">#for (i in 1:k)</span>
<span class="co">#plot(psi[i, (b+1):n], type=&quot;l&quot;,xlab=i, ylab=bquote(psi))</span>
<span class="co">#par(mfrow=c(1,1)) #restore default</span>
<span class="co">#the sequence of R-hat statistics</span>
rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)
<span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)
rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])
<span class="co">#plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;)</span>
<span class="co">#abline(h=1.2, lty=2)</span></code></pre></div>
<p>It seems the chain has approximately converged to the target distribution since <span class="math inline">\(n=8000\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nc=<span class="dv">8000</span>
thetahat=<span class="kw">mean</span>(<span class="kw">rowMeans</span>(psi[,nc<span class="op">:</span>n])) 
thetahat</code></pre></div>
<pre><code>## [1] 0.6243849</code></pre>
<p>Q2: 11.4 Find the intersection points A(k) in <span class="math inline">\((0, \sqrt{k})\)</span> of the curves <span class="math display">\[  S_{k-1}(a)=p \left( t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}} \right) \]</span> and <span class="math display">\[  S_{k}(a)=p \left( t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}} \right) \]</span> for <span class="math inline">\(k = 4:25, 100, 500, 1000\)</span>, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Szekely [260].)</p>
<p>A2: The problem becomes solving <span class="math inline">\(f(a)=S_{k-1}(a)-S_{k}(a)=0\)</span>, given k.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mys&lt;-<span class="cf">function</span>(a,k){
    M=<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))
    <span class="kw">return</span>(<span class="kw">pt</span>(M,<span class="dt">df=</span>k,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>))
}
myf&lt;-<span class="cf">function</span>(a,k){
 <span class="kw">mys</span>(<span class="dt">a=</span>a,<span class="dt">k=</span>(k<span class="op">-</span><span class="dv">1</span>))<span class="op">-</span><span class="kw">mys</span>(<span class="dt">a=</span>a,<span class="dt">k=</span>k)
}
kc=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)
A=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(kc))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(kc)){
  A[i]=<span class="kw">uniroot</span>(myf,<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="kw">sqrt</span>(kc[i]<span class="op">-</span><span class="dv">1</span>)),<span class="dt">k=</span>kc[i])<span class="op">$</span>root
}
<span class="kw">cbind</span>(kc,A)</code></pre></div>
<pre><code>##         kc         A
##  [1,]    4  1.492119
##  [2,]    5  1.533558
##  [3,]    6  1.562757
##  [4,]    7  1.584430
##  [5,]    8  1.601180
##  [6,]    9  1.614519
##  [7,]   10  1.625384
##  [8,]   11  1.634381
##  [9,]   12  1.642026
## [10,]   13  1.648547
## [11,]   14  1.654150
## [12,]   15  1.659097
## [13,]   16  1.663432
## [14,]   17  1.667283
## [15,]   18  1.670724
## [16,]   19  1.673817
## [17,]   20  1.676614
## [18,]   21  1.679154
## [19,]   22  1.681442
## [20,]   23  1.683575
## [21,]   24  1.685536
## [22,]   25  1.687343
## [23,]  100  1.720599
## [24,]  500 22.338308
## [25,] 1000 31.606961</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(kc,A,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmtv+QOgCQOmaQtpCQ2/+2ZgC2Zma2/7a2///bkDrb////tmb/25D//7b//9v////i3QL9AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGrUlEQVR4nO2di3KjOBBFcR47m2x249045PH/H7ogYSZlkC9I3eoG31M1rqkgNfhYSAIaaL7JVRrrDfAOBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCCAtqNoOVINlwCgxuKChB8+Pf4grC6/dMc/6koHma76ahoCuMHRAFzdD3z+yDkgwjO0exWSYTHwr6ycy0sLKg9RPUesxvFFvQQOono6BAukVTUGrfOi9cHEViU9TCFQC6wxsXhEeLmxa0ZCy9XUELpxq3KmjxRExF0OfzU/fZdr/R3ZtAOHHWzFP1BJ3u3/v//VUeTph1s3g1QYOaoKkwnCSrD3LUBH08BkFtYiezEZRxCHhDLSjvCFlJUH+8/vB97q4Lw4mQe/5Aa5jvHB1eu4Es4aeyoILTK7cwDyo6+bT7E2alq1ISdOq2K3bStqNY+Q+hI+jU9T+fz30vbSpIop2qCPp6eQqf3RBvJ0hoN1Ya5uMBxvH+3UqQWCen2II6jg8mgiTHAKU+aNDSzYbqCWrGS6KiUcULBk5xDOvaUjVB8UK6+ARiNxPFeCFdx7tsQZNwIeCQkyEeV7igSbiwd2mE3Y8gJT/7EaTQPw9xpQuahNObWO1FkNrEcyeC9Cbm+xCkeOCyixNmmgd2e2hBuge+RlshGE73zMn2BSmfWaIgqfBeBamfmhQvWDec+rntfEFff6dyf0TXWyWMxBouCp6uJEeJrrdCFJlV/CzY544dXtNla2WY1bi4tl5QTN1IJSUMRapkmNW5+Liy4DHktSSzWiJ18oPqXL1eKWj42gsE6WeYuRQUOhYfLahW+sP6gscFfZB+hlklP3mjWC/g2ij2rZ9hVstP9jyotZ0HVfNTcqjxb4YgoRNm9fxs81isop9NCqrpR0dQHMUiCvOg7QtKZ73khROrqrm2dZv19fIgGU6mpu7qVm5X2ySOUvPCCVTUXp+TTrq2n60Jqu5nY4Lq+9mWIAM/FCS2TgeCLPxsSZCJnw0JsvGzHUFGfjYjyMpPbUG5J8zM/GykBdn5oSCxVVsKMvSzCUGWfrYgyNTPBgTZ+vEvyNiPe0HWfrwLMvdDQWJbYCLI3o9vQQ78uBbkwY/WtXmJNGAXfhQFlaYB+/CjJ6g0idOJHz1B82nAi0+YefHjtgXtXVBpGrAbP2rDfFkasB8/PudBjvy4FOTJj0dBrvw4FOTLjz9BzvzYCrqcMzYqTyErw1LQ5ay6kV9NOYaCopvfhqIfb4asBU3eG0xBY7i5FkRBP8OxD0Lh5kYxb7ibB3nDTNBmMBK0KGjhWTXl6mXFRYJSEAWVBaUgCioLSkEUVBaUgijohqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEAeUHt3ANhv16a4Um64+LZcik+HmN6bVb1j19v81WXxBAX1PZZsJer/Xrp/nLqv+K4eLZcMuj9e3yHck71z+eQ9T6tuiiGtKD4strjxdMEY37+6e5tXDxf7mrQzOrD83unVZfFkBY0qpjb1MPruPhauWnQP14voi+v3jZP4b6JadVlMcQFhe8y/0T3Y7dR58XXyk1o7/57Dl1YbvW3uarLYkgLivv07J7d5+ePi6+Um3Lqd5L+KaB51YODadVlMeoJas99dIagw/Bb70BQst3G+zvy9pHYT3R9xg52sVTPd4qzoLxOOn6J7gsVVPfSSSfGzt+vGc8Z5uNNam3uLKH1NMzPz74+Hp8uF6+aKPb374Xvk1W99TRRDC+Ymqz0FLO6+r+Pi+fKJWnPRyo51YduZlp1SQwerAIoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAM+Cko/UrQkFASgI4F5QSE3r02eWJUuJ411QSE3rkzitmpNzQeH99qa7mm9Bf8bU2MfESypq4FvQ4Z8+VXe8E8EC34Kevo/372xBKc7v8WAflCCIOd69hVGsv1XDAveCwn10nAf5hYIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwPkAhMiqgxreIAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="section-7" class="section level2">
<h2>2018-11-30</h2>
</div>
<div id="q1" class="section level2">
<h2>Q1:</h2>
<p>11.6 Write a function to compute the cdf of the Cauchy distribution, which has density <span class="math display">\[  \frac{1}{\pi\theta(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;\infty, \]</span> where <span class="math inline">\(\theta &gt; 0\)</span>. Compare your results to the results from the R function pcauchy. (Also see the source code in pcauchy.c.)</p>
</div>
<div id="a1" class="section level1">
<h1>A1:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cauchy&lt;-<span class="cf">function</span>(x,eta,theta){
   <span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>))  
}
mypcauchy&lt;-<span class="cf">function</span>(x,eta,theta){
  <span class="kw">integrate</span>(cauchy,<span class="dt">lower=</span><span class="op">-</span><span class="ot">Inf</span>,<span class="dt">upper=</span>x,<span class="dt">eta=</span>eta,<span class="dt">theta=</span>theta)
}
x=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dt">by=</span><span class="fl">0.5</span>)
eta=<span class="dv">1</span>
theta=<span class="dv">2</span>
mycdf=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(x))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){
  mycdf[i]=<span class="kw">mypcauchy</span>(x[i],<span class="dt">eta =</span> eta,<span class="dt">theta=</span>theta)<span class="op">$</span>value
}
Rcdf=<span class="kw">pcauchy</span>(x,<span class="dt">location =</span> eta,<span class="dt">scale=</span>theta)
<span class="kw">cbind</span>(x,mycdf,Rcdf)</code></pre></div>
<pre><code>##          x     mycdf      Rcdf
##  [1,] -2.0 0.1871670 0.1871670
##  [2,] -1.5 0.2147767 0.2147767
##  [3,] -1.0 0.2500000 0.2500000
##  [4,] -0.5 0.2951672 0.2951672
##  [5,]  0.0 0.3524164 0.3524164
##  [6,]  0.5 0.4220209 0.4220209
##  [7,]  1.0 0.5000000 0.5000000
##  [8,]  1.5 0.5779791 0.5779791
##  [9,]  2.0 0.6475836 0.6475836</code></pre>
<div id="q2" class="section level2">
<h2>Q2:</h2>
<p>A-B-O blood type problem</p>
<ol style="list-style-type: decimal">
<li>Let the three alleles be A, B, and O</li>
</ol>

<ol start="2" style="list-style-type: decimal">
<li>Observed data: <span class="math inline">\(nA· = nAA + nAO = 28 (A-type),\)</span> <span class="math inline">\(nB· = nBB + nBO = 24 (B-type),\)</span> <span class="math inline">\(nOO = 41 (O-type),\)</span> <span class="math inline">\(nAB = 70 (AB-type).\)</span></li>
<li>Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).</li>
<li>Record the maximum likelihood values in M-steps, are they increasing?</li>
</ol>
</div>
</div>
<div id="a2" class="section level1">
<h1>A2:</h1>
<p>E-step: <span class="math display">\[nAA0=E_{p_0,q_0}[nAA|nA.]=nA.\frac{p_0^2}{P_0^2+2p_0(1-p_0-q_0)}\]</span> <span class="math display">\[nBB0=E_{p_0,q_0}[nBB|nB.]=nB.\frac{q_0^2}{q_0^2+2q_0(1-p_0-q_0)}\]</span> M-step: <span class="math display">\[L(p,q)=(p^2)^{nAA}(q^2)^{nBB}(r^2)^{nOO}(2pr)^{nAO}(2qr)^{nBO}(2pq)^{nAB}\]</span> Get MLE of p,q as new p0,q0 in E-step. Repeat this process until convergence. We can get MLE of p,q as follows</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nA=<span class="dv">28</span>
nB=<span class="dv">24</span>
nOO=<span class="dv">41</span>
nAB=<span class="dv">70</span>
l&lt;-<span class="cf">function</span>(theta,nAA,nBB){
  p=theta[<span class="dv">1</span>]
  q=theta[<span class="dv">2</span>]
  r=<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q
  <span class="kw">return</span>(<span class="op">-</span>(<span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span>(nA<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>(nB<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)))
  }
MLE&lt;-<span class="cf">function</span>(p0,q0){
  r0=<span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0
  nAA0=nA<span class="op">*</span>p0<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0)
  nBB0=nB<span class="op">*</span>q0<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0)
  <span class="kw">return</span>(<span class="kw">optim</span>(<span class="kw">c</span>(p0,q0),l,<span class="dt">lower=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),<span class="dt">upper=</span><span class="kw">c</span>(<span class="fl">0.49</span>,<span class="fl">0.49</span>),<span class="dt">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>,<span class="dt">nAA=</span>nAA0,<span class="dt">nBB=</span>nBB0)<span class="op">$</span>par)
}
EM&lt;-<span class="cf">function</span>(p0,q0,l,maxiter){
  theta0=<span class="kw">c</span>(p0,q0)
  theta=<span class="kw">MLE</span>(p0,q0)
  record=<span class="kw">rbind</span>(theta0,theta)
  iter=<span class="dv">1</span>
  <span class="cf">while</span>((<span class="kw">max</span>(<span class="kw">abs</span>(theta<span class="op">-</span><span class="kw">c</span>(p0,q0)))<span class="op">&gt;</span>l)<span class="op">&amp;</span>(iter<span class="op">&lt;=</span>maxiter)){
    p0=theta[<span class="dv">1</span>]
    q0=theta[<span class="dv">2</span>]
    theta=<span class="kw">MLE</span>(p0,q0)
    record=<span class="kw">rbind</span>(record,theta)
    iter=iter<span class="op">+</span><span class="dv">1</span>
  }
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">record=</span>record,<span class="dt">iter=</span>iter))
}
result=<span class="kw">EM</span>(<span class="fl">0.4</span>,<span class="fl">0.2</span>,<span class="fl">0.000001</span>,<span class="dv">1000</span>)
result <span class="co">#the first column records MLE of p, the second column records MLE of q</span></code></pre></div>
<pre><code>## $record
##             [,1]      [,2]
## theta0 0.4000000 0.2000000
## theta  0.3292434 0.3030677
## theta  0.3271758 0.3098293
## theta  0.3272959 0.3103645
## theta  0.3273387 0.3104164
## theta  0.3273446 0.3104242
## theta  0.3273452 0.3104259
## theta  0.3273444 0.3104268
## 
## $iter
## [1] 7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matplot</span>(result<span class="op">$</span>record,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;iteration time&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;MLE&quot;</span>,<span class="dt">main=</span><span class="st">&quot;EM-record&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">inset=</span>.<span class="dv">05</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;q&quot;</span>),
       <span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">horiz=</span><span class="ot">FALSE</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can find p converges to 0.32, q converges to 0.31 almost.</p>
<div id="section-8" class="section level2">
<h2>2018-12-7</h2>
<p>Q1: 3.Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list</p>
<p>A1：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12</span>)
<span class="kw">attach</span>(mtcars)
formulas &lt;-<span class="st"> </span><span class="kw">list</span>(
mpg <span class="op">~</span><span class="st"> </span>disp,
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),
mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt
)
result1=<span class="kw">lapply</span>(formulas,lm)
result1</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result2=result1
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){
  result2[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]])
}
result2</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>Q2: 4.Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply().Can you do it without an anonymous function?</p>
<p>A2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
mtcars[rows, ]})
result3=<span class="kw">lapply</span>(bootstraps,<span class="cf">function</span>(a){<span class="kw">lm</span>(a<span class="op">$</span>mpg<span class="op">~</span>a<span class="op">$</span>disp)})
result3</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    29.09282     -0.04032  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    30.69042     -0.04482  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    29.64310     -0.04024  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    29.38534     -0.03999  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    31.72740     -0.05314  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    28.47092     -0.03623  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    28.10593     -0.03564  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    27.50581     -0.03488  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    29.97662     -0.04217  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = a$mpg ~ a$disp)
## 
## Coefficients:
## (Intercept)       a$disp  
##    29.79607     -0.04326</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result4=result3
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){
  result4[[i]]=<span class="kw">lm</span>(bootstraps[[i]]<span class="op">$</span>mpg<span class="op">~</span>bootstraps[[i]]<span class="op">$</span>disp)
}
result4</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.09282              -0.04032  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             30.69042              -0.04482  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.64310              -0.04024  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.38534              -0.03999  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             31.72740              -0.05314  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.47092              -0.03623  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.10593              -0.03564  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             27.50581              -0.03488  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.97662              -0.04217  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.79607              -0.04326</code></pre>
<p>Q3: 5.For each model in the previous two exercises, extract R2 using the function below.</p>
<p>A3:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared
<span class="kw">lapply</span>(result1,rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(result2,rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(result3,rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.8630147
## 
## [[2]]
## [1] 0.6953983
## 
## [[3]]
## [1] 0.6290129
## 
## [[4]]
## [1] 0.7225284
## 
## [[5]]
## [1] 0.7934105
## 
## [[6]]
## [1] 0.6705007
## 
## [[7]]
## [1] 0.654581
## 
## [[8]]
## [1] 0.6283484
## 
## [[9]]
## [1] 0.704806
## 
## [[10]]
## [1] 0.6420804</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(result4,rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.8630147
## 
## [[2]]
## [1] 0.6953983
## 
## [[3]]
## [1] 0.6290129
## 
## [[4]]
## [1] 0.7225284
## 
## [[5]]
## [1] 0.7934105
## 
## [[6]]
## [1] 0.6705007
## 
## [[7]]
## [1] 0.654581
## 
## [[8]]
## [1] 0.6283484
## 
## [[9]]
## [1] 0.704806
## 
## [[10]]
## [1] 0.6420804</code></pre>
<p>Q4: 3.The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>A4:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12</span>)
trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(
  <span class="dv">100</span>,
  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),
  <span class="dt">simplify =</span> <span class="ot">FALSE</span>
)
<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="cf">function</span>(i){trials[[i]]<span class="op">$</span>p.value})</code></pre></div>
<pre><code>##   [1] 0.082499937 0.330784795 0.993047864 0.477290348 0.406404458
##   [6] 0.085187996 0.844111822 0.379938241 0.635628066 0.786437709
##  [11] 0.526876535 0.715040454 0.110824795 0.809350882 0.065930332
##  [16] 0.808664441 0.859265752 0.608593210 0.651687787 0.793923636
##  [21] 0.387259211 0.012011087 0.304023541 0.229197439 0.765511648
##  [26] 0.231204886 0.898434865 0.308273827 0.098051642 0.064364010
##  [31] 0.772742843 0.961870044 0.126951686 0.678720694 0.149908710
##  [36] 0.027666868 0.673732195 0.276325272 0.525299726 0.935774019
##  [41] 0.577354583 0.550658883 0.523809077 0.821460941 0.798589758
##  [46] 0.521098617 0.896046097 0.286044180 0.195748512 0.431651130
##  [51] 0.754932607 0.588776309 0.547781320 0.417193253 0.452785842
##  [56] 0.013746851 0.638739685 0.745462528 0.882385322 0.089179648
##  [61] 0.003132675 0.442411777 0.703167263 0.482340507 0.498785819
##  [66] 0.925679134 0.932265499 0.016249868 0.759802613 0.226230558
##  [71] 0.944056294 0.273858627 0.453569026 0.245504470 0.634473466
##  [76] 0.780832008 0.650077794 0.248769279 0.279270617 0.949787094
##  [81] 0.824539608 0.333125010 0.612011717 0.268620544 0.283314643
##  [86] 0.419813050 0.017097642 0.641691213 0.221103687 0.200611697
##  [91] 0.647253469 0.550783330 0.147248867 0.748154631 0.377174096
##  [96] 0.849968120 0.759417068 0.900474893 0.582294493 0.615195429</code></pre>
<p>Q5: Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
<p>A5:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(foreach)
<span class="kw">library</span>(datasets)

formulas &lt;-<span class="st"> </span><span class="kw">list</span>(
   mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>mtcars<span class="op">$</span>disp,
   mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mtcars<span class="op">$</span>disp),
   mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>mtcars<span class="op">$</span>disp <span class="op">+</span><span class="st"> </span>mtcars<span class="op">$</span>wt,
   mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mtcars<span class="op">$</span>disp) <span class="op">+</span><span class="st"> </span>mtcars<span class="op">$</span>wt
)

<span class="kw">foreach</span>(<span class="dt">i=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="op">%do%</span>
<span class="st">  </span><span class="kw">lm</span>(formulas[[i]])</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)  mtcars$disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
##      (Intercept)  I(1/mtcars$disp)  
##            10.75           1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)  mtcars$disp    mtcars$wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
##      (Intercept)  I(1/mtcars$disp)         mtcars$wt  
##           19.024          1142.560            -1.798</code></pre>
</div>
<div id="section-9" class="section level2">
<h2>2018-12-14</h2>
<p>Q1: 4. Make a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. You can try simplifying chisq.test() or by coding from the mathematical definition (<a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a>).</p>
<p>A1:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12</span>)
x=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dv">1000</span>,<span class="dt">prob =</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="fl">0.3</span>) ,<span class="dt">replace =</span> <span class="ot">TRUE</span>)
y=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>),<span class="dv">1000</span>,<span class="dt">prob =</span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.2</span>) ,<span class="dt">replace =</span> <span class="ot">TRUE</span>)
my_chisqtest&lt;-<span class="cf">function</span>(x,y){
  A=<span class="kw">table</span>(x,y)
  n=<span class="kw">nrow</span>(A)
  p=<span class="kw">ncol</span>(A)
  N=<span class="kw">sum</span>(A)
  rowp=<span class="kw">rowSums</span>(A)<span class="op">/</span>N
  colp=<span class="kw">colSums</span>(A)<span class="op">/</span>N
  E=N<span class="op">*</span>rowp<span class="op">%*%</span><span class="kw">t</span>(colp)
  chisq=<span class="kw">sum</span>((A<span class="op">-</span>E)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)
  <span class="kw">return</span>(chisq)
}
<span class="kw">library</span>(microbenchmark)
<span class="kw">microbenchmark</span>(<span class="kw">chisq.test</span>(x,y),<span class="dt">times=</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>## Unit: milliseconds
##              expr      min       lq     mean   median       uq      max
##  chisq.test(x, y) 2.317121 2.401695 2.804839 2.533069 2.886344 8.689616
##  neval
##   1000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">microbenchmark</span>(<span class="kw">my_chisqtest</span>(x,y),<span class="dt">times=</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>## Unit: milliseconds
##                expr      min       lq     mean   median       uq     max
##  my_chisqtest(x, y) 2.151672 2.162757 2.267195 2.197858 2.239118 11.9592
##  neval
##   1000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(x,y)</code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test
## 
## data:  x and y
## X-squared = 3.9856, df = 4, p-value = 0.408</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_chisqtest</span>(x,y)</code></pre></div>
<pre><code>## [1] 3.985577</code></pre>
<p>Q2: 5. Can you make a faster version of table() for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</p>
<p>A2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_table1&lt;-<span class="cf">function</span>(x,y){
  x=<span class="kw">factor</span>(x)
  y=<span class="kw">factor</span>(y)
  xl=<span class="kw">levels</span>(x)
  yl=<span class="kw">levels</span>(y)
  n=<span class="kw">length</span>(x)
  nxl=<span class="kw">length</span>(xl)
  nyl=<span class="kw">length</span>(yl)
  table=<span class="kw">matrix</span>(<span class="dv">0</span>,nxl,nyl,<span class="dt">dimnames =</span> <span class="kw">list</span>(xl,yl))
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nxl){
      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nyl){
        <span class="cf">if</span>(x[i]<span class="op">==</span>xl[j]<span class="op">&amp;</span>y[i]<span class="op">==</span>yl[k])
          table[j,k]=table[j,k]<span class="op">+</span><span class="dv">1</span>
      }
    }
  }
  <span class="kw">return</span>(table)
}
<span class="kw">library</span>(microbenchmark)
<span class="kw">microbenchmark</span>(<span class="kw">my_table1</span>(x,y),<span class="dt">times=</span><span class="dv">10</span>)</code></pre></div>
<pre><code>## Unit: milliseconds
##             expr      min       lq     mean   median       uq      max
##  my_table1(x, y) 412.7588 413.4161 425.4648 416.2386 421.1499 472.2469
##  neval
##     10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">microbenchmark</span>(<span class="kw">table</span>(x,y),<span class="dt">times=</span><span class="dv">10</span>)</code></pre></div>
<pre><code>## Unit: milliseconds
##         expr      min       lq     mean   median       uq      max neval
##  table(x, y) 2.094195 2.094606 2.160704 2.126834 2.178767 2.438233    10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_table1</span>(x,y)</code></pre></div>
<pre><code>##     4   5  6
## 1  69  79 40
## 2 214 205 87
## 3 137 120 49</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(x,y)</code></pre></div>
<pre><code>##    y
## x     4   5   6
##   1  69  79  40
##   2 214 205  87
##   3 137 120  49</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_table2&lt;-<span class="cf">function</span>(x,y){
  x=<span class="kw">factor</span>(x)
  y=<span class="kw">factor</span>(y)
  xl=<span class="kw">levels</span>(x)
  yl=<span class="kw">levels</span>(y)
  n=<span class="kw">length</span>(x)
  nxl=<span class="kw">length</span>(xl)
  nyl=<span class="kw">length</span>(yl)
  table=<span class="kw">matrix</span>(<span class="dv">0</span>,nxl,nyl,<span class="dt">dimnames =</span> <span class="kw">list</span>(xl,yl))
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nxl){
    xi=<span class="kw">factor</span>(x,<span class="dt">levels=</span>xl[i])
    I=<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(xi))
    table[i,]=<span class="kw">tabulate</span>(y[I])
  }
  <span class="kw">return</span>(table)
}
<span class="kw">library</span>(microbenchmark)
<span class="kw">microbenchmark</span>(<span class="kw">my_table2</span>(x,y),<span class="dt">times=</span><span class="dv">10</span>)</code></pre></div>
<pre><code>## Unit: milliseconds
##             expr      min       lq     mean   median       uq     max
##  my_table2(x, y) 2.205863 2.241171 3.578278 2.289614 2.347502 14.6647
##  neval
##     10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">microbenchmark</span>(<span class="kw">table</span>(x,y),<span class="dt">times=</span><span class="dv">10</span>)</code></pre></div>
<pre><code>## Unit: milliseconds
##         expr      min       lq     mean   median       uq      max neval
##  table(x, y) 2.101995 2.106102 2.230209 2.123959 2.207506 2.880801    10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_table2</span>(x,y)</code></pre></div>
<pre><code>##     4   5  6
## 1  69  79 40
## 2 214 205 87
## 3 137 120 49</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(x,y)</code></pre></div>
<pre><code>##    y
## x     4   5   6
##   1  69  79  40
##   2 214 205  87
##   3 137 120  49</code></pre>
<p>The function my_table1() using multiple loops is slower.And the function my_table2() is almost as fast as table().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_chisqtest1&lt;-<span class="cf">function</span>(x,y){
  A=<span class="kw">my_table2</span>(x,y)
  n=<span class="kw">nrow</span>(A)
  p=<span class="kw">ncol</span>(A)
  N=<span class="kw">sum</span>(A)
  rowp=<span class="kw">rowSums</span>(A)<span class="op">/</span>N
  colp=<span class="kw">colSums</span>(A)<span class="op">/</span>N
  E=N<span class="op">*</span>rowp<span class="op">%*%</span><span class="kw">t</span>(colp)
  chisq=<span class="kw">sum</span>((A<span class="op">-</span>E)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)
  <span class="kw">return</span>(chisq)
}
<span class="kw">library</span>(microbenchmark)
<span class="kw">microbenchmark</span>(<span class="kw">chisq.test</span>(x,y),<span class="dt">times=</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>## Unit: milliseconds
##              expr     min       lq     mean   median       uq      max
##  chisq.test(x, y) 2.32369 2.401694 2.796874 2.471281 2.775497 84.94319
##  neval
##   1000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">microbenchmark</span>(<span class="kw">my_chisqtest1</span>(x,y),<span class="dt">times=</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>## Unit: milliseconds
##                 expr      min       lq     mean   median       uq    max
##  my_chisqtest1(x, y) 2.231318 2.249792 2.507237 2.315274 2.428174 13.018
##  neval
##   1000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(x,y)</code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test
## 
## data:  x and y
## X-squared = 3.9856, df = 4, p-value = 0.408</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_chisqtest1</span>(x,y)</code></pre></div>
<pre><code>## [1] 3.985577</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
